!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(this,function(){return webpackJsonp([3],{"./node_modules/babel-runtime/helpers/defineProperty.js":function(e,t,n){"use strict";t.__esModule=!0;var i=n("./node_modules/babel-runtime/core-js/object/define-property.js"),o=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function(e,t,n){return t in e?(0,o.default)(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},"./src/editorDemo.js":function(e,t,n){"use strict";var i=n("./src/module/objectEditor.js"),o=function(e){return e&&e.__esModule?e:{default:e}}(i),r={init:function(){new o.default({container:$("#app"),textAreaId:"app"}),new o.default({container:$("#app1"),textAreaId:"app1"})}};$(function(){r.init()})},"./src/libs/ueditor/editor.js":function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n("./node_modules/babel-runtime/helpers/defineProperty.js"),r=i(o),a=n("./node_modules/babel-runtime/helpers/typeof.js"),s=i(a);!function(){window.UMEDITOR_HOME_URL=CONFIG.resourcePath+"/js/libs/ueditor/";var e=window.UMEDITOR_HOME_URL||function(){function e(){this.documentURL=self.document.URL||self.location.href,this.separator="/",this.separatorPattern=/\\|\//g,this.currentDir="./",this.currentDirPattern=/^[.]\/]/,this.path=this.documentURL,this.stack=[],this.push(this.documentURL)}function t(){var t=e.getProtocol(this.path||"");t?(this.protocol=t,this.localSeparator=/\\|\//.exec(this.path.replace(t,""))[0],this.stack=[]):(t=/\\|\//.exec(this.path))&&(this.localSeparator=t[0])}function n(){var t=this.path.replace(this.currentDirPattern,"");e.hasProtocol(this.path)&&(t=t.replace(this.protocol,"")),t=t.split(this.localSeparator),t.length=t.length-1;for(var n,i=0,o=t.length,r=this.stack;i<o;i++)(n=t[i])&&(e.isParentPath(n)?r.pop():r.push(n))}e.isParentPath=function(e){return".."===e},e.hasProtocol=function(t){return!!e.getProtocol(t)},e.getProtocol=function(e){var t=/^[^:]*:\/*/.exec(e);return t?t[0]:null},e.prototype={push:function(e){return this.path=e,t.call(this),n.call(this),this},getPath:function(){return this+""},toString:function(){return this.protocol+this.stack.concat([""]).join(this.separator)}};var i=document.getElementsByTagName("script");return i=i[i.length-1].src,(new e).push(i)+""}();window.UMEDITOR_CONFIG={UMEDITOR_HOME_URL:e,imageUrl:e+"jsp/imageUp.jsp",imagePath:e+"jsp/",imageFieldName:"upfile",toolbar:[],filterRules:function(){return{span:function(e){if(/Wingdings|Symbol/.test(e.getStyle("font-family")))return!0;e.parentNode.removeChild(e,!0)},p:function(e){var t;"MsoListParagraph"==e.getAttr("class")&&(t="MsoListParagraph"),e.setAttr(),t&&e.setAttr("class","MsoListParagraph"),e.firstChild()||e.innerHTML(UE.browser.ie?"&nbsp;":"<br>")},div:function(e){for(var t,n=UM.uNode.createElement("p");t=e.firstChild();)"text"!=t.type&&UM.dom.dtd.$block[t.tagName]?n.firstChild()?(e.parentNode.insertBefore(n,e),n=UM.uNode.createElement("p")):e.parentNode.insertBefore(t,e):n.appendChild(t);n.firstChild()&&e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e)},br:{$:{}},ol:{$:{}},ul:{$:{}},dl:function(e){e.tagName="ul",e.setAttr()},dt:function(e){e.tagName="li",e.setAttr()},dd:function(e){e.tagName="li",e.setAttr()},li:function(e){var t=e.getAttr("class");t&&/list\-/.test(t)||e.setAttr();var n=e.getNodesByTagName("ol ul");UM.utils.each(n,function(t){e.parentNode.insertAfter(t,e)})},table:function(e){UM.utils.each(e.getNodesByTagName("table"),function(e){UM.utils.each(e.getNodesByTagName("tr"),function(t){for(var n,i=UM.uNode.createElement("p"),o=[];n=t.firstChild();)o.push(n.innerHTML()),t.removeChild(n);i.innerHTML(o.join("&nbsp;&nbsp;")),e.parentNode.insertBefore(i,e)}),e.parentNode.removeChild(e)});var t=e.getAttr("width");e.setAttr(),t&&e.setAttr("width",t)},tbody:{$:{}},caption:{$:{}},th:{$:{}},td:{$:{valign:1,align:1,rowspan:1,colspan:1,width:1,height:1}},tr:{$:{}},h3:{$:{}},h2:{$:{}},"-":"script style meta iframe embed object"}}()}}(),/*!
 * UEditor Mini版本
 * version: 1.2.2
 * build: Wed Mar 19 2014 17:14:25 GMT+0800 (中国标准时间)
 */
function(e){function t(e,t,n){var i;return t=t.toLowerCase(),(i=e.__allListeners||n&&(e.__allListeners={}))&&(i[t]||n&&(i[t]=[]))}function n(e,t,i,o,r,a){var s,l=o&&e[t];for(!l&&(l=e[i]);!l&&(s=(s||e).parentNode);){if("BODY"==s.tagName||a&&!a(s))return null;l=s[i]}return l&&r&&!r(l)?n(l,t,i,!1,r):l}var i;UMEDITOR_CONFIG=window.UMEDITOR_CONFIG||{},window.UM={plugins:{},commands:{},I18N:{},version:"1.2.2"};var o=UM.dom={},a=UM.browser=function(){var e=navigator.userAgent.toLowerCase(),t=window.opera,n={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(e),opera:!!t&&t.version,webkit:e.indexOf(" applewebkit/")>-1,mac:e.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode};n.gecko="Gecko"==navigator.product&&!n.webkit&&!n.opera&&!n.ie;var i=0;if(n.ie){var o=e.match(/(?:msie\s([\w.]+))/),r=e.match(/(?:trident.*rv:([\w.]+))/);i=o&&r&&o[1]&&r[1]?Math.max(1*o[1],1*r[1]):o&&o[1]?1*o[1]:r&&r[1]?1*r[1]:0,n.ie11Compat=11==document.documentMode,n.ie9Compat=9==document.documentMode,n.ie8=!!document.documentMode,n.ie8Compat=8==document.documentMode,n.ie7Compat=7==i&&!document.documentMode||7==document.documentMode,n.ie6Compat=i<7||n.quirks,n.ie9above=i>8,n.ie9below=i<9}if(n.gecko){var a=e.match(/rv:([\d\.]+)/);a&&(a=a[1].split("."),i=1e4*a[0]+100*(a[1]||0)+1*(a[2]||0))}return/chrome\/(\d+\.\d)/i.test(e)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(e)&&!/chrome/i.test(e)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(i=parseFloat(t.version())),n.webkit&&(i=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),n.version=i,n.isCompatible=!n.mobile&&(n.ie&&i>=6||n.gecko&&i>=10801||n.opera&&i>=9.5||n.air&&i>=1||n.webkit&&i>=522||!1),n}(),l=a.ie,d=(a.webkit,a.gecko,a.opera,UM.utils={each:function(e,t,n){if(null!=e)if(e.length===+e.length){for(var i=0,o=e.length;i<o;i++)if(!1===t.call(n,e[i],i,e))return!1}else for(var r in e)if(e.hasOwnProperty(r)&&!1===t.call(n,e[r],r,e))return!1},makeInstance:function(e){var t=new Function;return t.prototype=e,e=new t,t.prototype=null,e},extend:function(e,t,n){if(t)for(var i in t)n&&e.hasOwnProperty(i)||(e[i]=t[i]);return e},extend2:function(e){for(var t=arguments,n=1;n<t.length;n++){var i=t[n];for(var o in i)e.hasOwnProperty(o)||(e[o]=i[o])}return e},inherits:function(e,t){var n=e.prototype,i=d.makeInstance(t.prototype);return d.extend(i,n,!0),e.prototype=i,i.constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,n){var i;return function(){n&&clearTimeout(i),i=setTimeout(e,t)}},indexOf:function(e,t,n){var i=-1;return n=this.isNumber(n)?n:0,this.each(e,function(e,o){if(o>=n&&e===t)return i=o,!1}),i},removeItem:function(e,t){for(var n=0,i=e.length;n<i;n++)e[n]===t&&(e.splice(n,1),n--)},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=d.isArray(e)?e:e.split(",");for(var t,n=0,i={};t=e[n++];)i[t.toUpperCase()]=i[t]=1;return i},unhtml:function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},html:function(e){return e?e.replace(/&((g|l|quo)t|amp|#39);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'"}[e]}):""},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t={float:void 0!=e.cssFloat?"cssFloat":void 0!=e.styleFloat?"styleFloat":"float"};return function(e){return t[e]||(t[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))}}(),loadFile:function(){function e(e,n){try{for(var i,o=0;i=t[o++];)if(i.doc===e&&i.url==(n.src||n.href))return i}catch(e){return null}}var t=[];return function(n,i,o){var r=e(n,i);if(r)return void(r.ready?o&&o():r.funs.push(o));if(t.push({doc:n,url:i.src||i.href,funs:[o]}),!n.body){var a=[];for(var s in i)"tag"!=s&&a.push(s+'="'+i[s]+'"');return void n.write("<"+i.tag+" "+a.join(" ")+" ></"+i.tag+">")}if(!i.id||!n.getElementById(i.id)){var l=n.createElement(i.tag);delete i.tag;for(var s in i)l.setAttribute(s,i[s]);l.onload=l.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){if(r=e(n,i),r.funs.length>0){r.ready=1;for(var t;t=r.funs.pop();)t()}l.onload=l.onreadystatechange=null}},l.onerror=function(){throw Error("The load "+(i.href||i.src)+" fails,check the url settings of file umeditor.config.js ")},n.getElementsByTagName("head")[0].appendChild(l)}}}(),isEmptyObject:function(e){if(null==e)return!0;if(this.isArray(e)||this.isString(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},fixColor:function(e,t){if(/color/i.test(e)&&/rgba?/.test(t)){var n=t.split(",");if(n.length>3)return"";t="#";for(var i,o=0;i=n[o++];)i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16),t+=1==i.length?"0"+i:i;t=t.toUpperCase()}return t},clone:function(e,t){var n;t=t||{};for(var i in e)e.hasOwnProperty(i)&&(n=e[i],"object"==(void 0===n?"undefined":(0,s.default)(n))?(t[i]=d.isArray(n)?[]:{},d.clone(e[i],t[i])):t[i]=n);return t},transUnitToPx:function(e){if(!/(pt|cm)/.test(e))return e;var t;switch(e.replace(/([\d.]+)(\w+)/,function(n,i,o){e=i,t=o}),t){case"cm":e=25*parseFloat(e);break;case"pt":e=Math.round(96*parseFloat(e)/72)}return e+(e?"px":"")},cssRule:a.ie&&11!=a.version?function(e,t,n){var i,o;n=n||document,i=n.indexList?n.indexList:n.indexList={};var r;if(i[e])r=n.styleSheets[i[e]];else{if(void 0===t)return"";r=n.createStyleSheet("",o=n.styleSheets.length),i[e]=o}if(void 0===t)return r.cssText;r.cssText=t||""}:function(e,t,n){n=n||document;var i,o=n.getElementsByTagName("head")[0];if(!(i=n.getElementById(e))){if(void 0===t)return"";i=n.createElement("style"),i.id=e,o.appendChild(i)}if(void 0===t)return i.innerHTML;""!==t?i.innerHTML=t:o.removeChild(i)}});d.each(["String","Function","Array","Number","RegExp","Object"],function(e){UM.utils["is"+e]=function(t){return Object.prototype.toString.apply(t)=="[object "+e+"]"}});var c=UM.EventBase=function(){};c.prototype={addListener:function(e,n){e=d.trim(e).split(" ");for(var i,o=0;i=e[o++];)t(this,i,!0).push(n)},removeListener:function(e,n){e=d.trim(e).split(" ");for(var i,o=0;i=e[o++];)d.removeItem(t(this,i)||[],n)},fireEvent:function(){var e=arguments[0];e=d.trim(e).split(" ");for(var n,i=0;n=e[i++];){var o,r,a,s=t(this,n);if(s)for(a=s.length;a--;)if(s[a]){if(!0===(r=s[a].apply(this,arguments)))return r;void 0!==r&&(o=r)}(r=this["on"+n.toLowerCase()])&&(o=r.apply(this,arguments))}return o}};var u=o.dtd=function(){function e(e){for(var t in e)e[t.toUpperCase()]=e[t];return e}var t=d.extend2,n=e({isindex:1,fieldset:1}),i=e({input:1,button:1,select:1,textarea:1,label:1}),o=t(e({a:1}),i),r=t({iframe:1},o),a=e({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),s=e({ins:1,del:1,script:1,style:1}),l=t(e({b:1,acronym:1,bdo:1,var:1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),s),c=t(e({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),l),u=t(e({p:1}),c),f=t(e({iframe:1}),c,i),h=e({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,var:1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),p=t(e({a:0}),f),m=e({tr:1}),g=e({"#":1}),v=t(e({param:1}),h),b=t(e({form:1}),n,r,a,u),y=e({li:1,ol:1,ul:1}),C=e({style:1,script:1}),x=e({base:1,link:1,meta:1,title:1}),N=t(x,C),k=e({head:1,body:1}),w=e({html:1}),E=e({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),S=e({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return e({$nonBodyContent:t(w,k,x),$block:E,$inline:p,$inlineWithA:t(e({a:1}),p),$body:t(e({script:1,style:1}),E),$cdata:e({script:1,style:1}),$empty:S,$nonChild:e({iframe:1,textarea:1}),$listItem:e({dd:1,dt:1,li:1}),$list:e({ul:1,ol:1,dl:1}),$isNotEmpty:e({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:e({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,var:1}),$removeEmptyBlock:e({p:1,div:1}),$tableContent:e({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:e({pre:1,script:1,style:1,textarea:1}),html:k,head:N,style:g,script:g,body:b,base:{},link:{},meta:{},title:g,col:{},tr:e({td:1,th:1}),img:{},embed:{},colgroup:e({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:b,td:b,br:{},th:b,center:b,kbd:p,button:t(u,a),basefont:{},h5:p,h4:p,samp:p,h6:p,ol:y,h1:p,h3:p,option:g,h2:p,form:t(n,r,a,u),select:e({optgroup:1,option:1}),font:p,ins:p,menu:y,abbr:p,label:p,table:e({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:p,tfoot:m,cite:p,li:b,input:{},iframe:b,strong:p,textarea:g,noframes:b,big:p,small:p,span:e({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:p,dt:p,sub:p,optgroup:e({option:1}),param:{},bdo:p,var:p,div:b,object:v,sup:p,dd:b,strike:p,area:{},dir:y,map:t(e({area:1,form:1,p:1}),n,s,a),applet:v,dl:e({dt:1,dd:1}),del:p,isindex:{},fieldset:t(e({legend:1}),h),thead:m,ul:y,acronym:p,b:p,a:t(e({a:1}),f),blockquote:t(e({td:1,tr:1,tbody:1,li:1}),b),caption:p,i:p,u:p,tbody:m,s:p,address:t(r,u),tt:p,legend:p,q:p,pre:t(l,o),p:t(e({a:1}),p),em:p,dfn:p})}(),f=l&&a.version<9?{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},h=d.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),p=o.domUtils=(i={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:l&&"6"==a.version?"\ufeff":"​",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},breakParent:function(e,t){var n,i,o,r=e,a=e;do{for(r=r.parentNode,i?(n=r.cloneNode(!1),n.appendChild(i),i=n,n=r.cloneNode(!1),n.appendChild(o),o=n):(i=r.cloneNode(!1),o=i.cloneNode(!1));n=a.previousSibling;)i.insertBefore(n,i.firstChild);for(;n=a.nextSibling;)o.appendChild(n);a=r}while(t!==r);return n=t.parentNode,n.insertBefore(i,t),n.insertBefore(o,t),n.insertBefore(e,o),p.remove(t),e},trimWhiteTextNode:function(e){function t(t){for(var n;(n=e[t])&&3==n.nodeType&&p.isWhitespace(n);)e.removeChild(n)}t("firstChild"),t("lastChild")},getPosition:function(e,t){if(e===t)return 0;var n,i=[e],o=[t];for(n=e;n=n.parentNode;){if(n===t)return 10;i.push(n)}for(n=t;n=n.parentNode;){if(n===e)return 20;o.push(n)}if(i.reverse(),o.reverse(),i[0]!==o[0])return 1;for(var r=-1;r++,i[r]===o[r];);for(e=i[r],t=o[r];e=e.nextSibling;)if(e===t)return 4;return 2},getNodeIndex:function(e,t){for(var n=e,i=0;n=n.previousSibling;)t&&3==n.nodeType?n.nodeType!=n.nextSibling.nodeType&&i++:i++;return i},inDoc:function(e,t){return 10==p.getPosition(e,t)},findParent:function(e,t,n){if(e&&!p.isBody(e))for(e=n?e:e.parentNode;e;){if(!t||t(e)||p.isBody(e))return t&&!t(e)&&p.isBody(e)?null:e;e=e.parentNode}return null},findParentByTagName:function(e,t,n,i){return t=d.listToMap(d.isArray(t)?t:[t]),p.findParent(e,function(e){return t[e.tagName]&&!(i&&i(e))},n)},findParents:function(e,t,n,i){for(var o=t&&(n&&n(e)||!n)?[e]:[];e=p.findParent(e,n);)o.push(e);return i?o:o.reverse()},insertAfter:function(e,t){return e.parentNode.insertBefore(t,e.nextSibling)},remove:function(e,t){var n,i=e.parentNode;if(i){if(t&&e.hasChildNodes())for(;n=e.firstChild;)i.insertBefore(n,e);i.removeChild(e)}return e},getNextDomNode:function(e,t,i,o){return n(e,"firstChild","nextSibling",t,i,o)},getPreDomNode:function(e,t,i,o){return n(e,"lastChild","previousSibling",t,i,o)},isBookmarkNode:function(e){return 1==e.nodeType&&e.id&&/^_baidu_bookmark_/i.test(e.id)},getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getCommonAncestor:function(e,t){if(e===t)return e;for(var n=[e],i=[t],o=e,r=-1;o=o.parentNode;){if(o===t)return o;n.push(o)}for(o=t;o=o.parentNode;){if(o===e)return o;i.push(o)}for(n.reverse(),i.reverse();r++,n[r]===i[r];);return 0==r?null:n[r-1]},clearEmptySibling:function(e,t,n){function i(e,t){for(var n;e&&!p.isBookmarkNode(e)&&(p.isEmptyInlineElement(e)||!new RegExp("[^\t\n\r"+p.fillChar+"]").test(e.nodeValue));)n=e[t],p.remove(e),e=n}!t&&i(e.nextSibling,"nextSibling"),!n&&i(e.previousSibling,"previousSibling")},split:function(e,t){var n=e.ownerDocument;if(a.ie&&t==e.nodeValue.length){var i=n.createTextNode("");return p.insertAfter(e,i)}var o=e.splitText(t);if(a.ie8){var r=n.createTextNode("");p.insertAfter(o,r),p.remove(r)}return o},isWhitespace:function(e){return!new RegExp("[^ \t\n\r"+p.fillChar+"]").test(e.nodeValue)},getXY:function(e){for(var t=0,n=0;e.offsetParent;)n+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;return{x:t,y:n}},isEmptyInlineElement:function(e){if(1!=e.nodeType||!u.$removeEmpty[e.tagName])return 0;for(e=e.firstChild;e;){if(p.isBookmarkNode(e))return 0;if(1==e.nodeType&&!p.isEmptyInlineElement(e)||3==e.nodeType&&!p.isWhitespace(e))return 0;e=e.nextSibling}return 1},isBlockElm:function(e){return 1==e.nodeType&&(u.$block[e.tagName]||h[p.getComputedStyle(e,"display")])&&!u.$nonChild[e.tagName]},getElementsByTagName:function(t,n,i){if(i&&d.isString(i)){var o=i;i=function(t){var n=!1;return e.each(d.trim(o).replace(/[ ]{2,}/g," ").split(" "),function(i,o){if(e(t).hasClass(o))return n=!0,!1}),n}}n=d.trim(n).replace(/[ ]{2,}/g," ").split(" ");for(var r,a=[],s=0;r=n[s++];)for(var l,c=t.getElementsByTagName(r),u=0;l=c[u++];)i&&!i(l)||a.push(l);return a},unSelectable:l&&a.ie9below||a.opera?function(e){e.onselectstart=function(){return!1},e.onclick=e.onkeyup=e.onkeydown=function(){return!1},e.unselectable="on",e.setAttribute("unselectable","on");for(var t,n=0;t=e.all[n++];)switch(t.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:t.unselectable="on",e.setAttribute("unselectable","on")}}:function(e){e.style.MozUserSelect=e.style.webkitUserSelect=e.style.msUserSelect=e.style.KhtmlUserSelect="none"},removeAttributes:function(e,t){t=d.isArray(t)?t:d.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0;n=t[i++];){switch(n=f[n]||n){case"className":e[n]="";break;case"style":e.style.cssText="",!a.ie&&e.removeAttributeNode(e.getAttributeNode("style"))}e.removeAttribute(n)}},createElement:function(e,t,n){return p.setAttributes(e.createElement(t),n)},setAttributes:function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];switch(n){case"class":e.className=i;break;case"style":e.style.cssText=e.style.cssText+";"+i;break;case"innerHTML":e[n]=i;break;case"value":e.value=i;break;default:e.setAttribute(f[n]||n,i)}}return e},getComputedStyle:function(t,n){return d.transUnitToPx(d.fixColor(n,e(t).css(n)))},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},removeStyle:function(e,t){a.ie?("color"==t&&(t="(^|;)"+t),e.style.cssText=e.style.cssText.replace(new RegExp(t+"[^:]*:[^;]+;?","ig"),"")):e.style.removeProperty?e.style.removeProperty(t):e.style.removeAttribute(d.cssStyleToDomStyle(t)),e.style.cssText||p.removeAttributes(e,["style"])},getStyle:function(e,t){var n=e.style[d.cssStyleToDomStyle(t)];return d.fixColor(t,n)},setStyle:function(e,t,n){e.style[d.cssStyleToDomStyle(t)]=n,d.trim(e.style.cssText)||this.removeAttributes(e,"style")},removeDirtyAttr:function(e){for(var t,n=0,i=e.getElementsByTagName("*");t=i[n++];)t.removeAttribute("_moz_dirty");e.removeAttribute("_moz_dirty")},getChildCount:function(e,t){var n=0,i=e.firstChild;for(t=t||function(){return 1};i;)t(i)&&n++,i=i.nextSibling;return n},isEmptyNode:function(e){return!e.firstChild||0==p.getChildCount(e,function(e){return!p.isBr(e)&&!p.isBookmarkNode(e)&&!p.isWhitespace(e)})},isBr:function(e){return 1==e.nodeType&&"BR"==e.tagName},isFillChar:function(e,t){return 3==e.nodeType&&!e.nodeValue.replace(new RegExp((t?"^":"")+p.fillChar),"").length},isEmptyBlock:function(e,t){if(1!=e.nodeType)return 0;if(t=t||new RegExp("[ \t\r\n"+p.fillChar+"]","g"),e[a.ie?"innerText":"textContent"].replace(t,"").length>0)return 0;for(var n in u.$isNotEmpty)if(e.getElementsByTagName(n).length)return 0;return 1},isCustomeNode:function(e){return 1==e.nodeType&&e.getAttribute("_ue_custom_node_")},fillNode:function(e,t){var n=a.ie?e.createTextNode(p.fillChar):e.createElement("br");t.innerHTML="",t.appendChild(n)},isBoundaryNode:function(e,t){for(var n;!p.isBody(e);)if(n=e,e=e.parentNode,n!==e[t])return!1;return!0}},(0,r.default)(i,"isFillChar",function(e,t){return 3==e.nodeType&&!e.nodeValue.replace(new RegExp((t?"^":"")+p.fillChar),"").length}),(0,r.default)(i,"isBody",function(t){return e(t).hasClass("edui-body-container")}),i),m=new RegExp(p.fillChar,"g");!function(){function t(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer===e.endContainer&&e.startOffset==e.endOffset}function n(e){return!e.collapsed&&1==e.startContainer.nodeType&&e.startContainer===e.endContainer&&e.endOffset-e.startOffset==1}function i(e,n,i,o){return 1==n.nodeType&&(u.$empty[n.tagName]||u.$nonChild[n.tagName])&&(i=p.getNodeIndex(n)+(e?0:1),n=n.parentNode),e?(o.startContainer=n,o.startOffset=i,o.endContainer||o.collapse(!0)):(o.endContainer=n,o.endOffset=i,o.startContainer||o.collapse(!1)),t(o),o}function r(e,t){try{if(d&&p.inDoc(d,e))if(d.nodeValue.replace(m,"").length)d.nodeValue=d.nodeValue.replace(m,"");else{var n=d.parentNode;for(p.remove(d);n&&p.isEmptyInlineElement(n)&&(a.safari?!(p.getPosition(n,t)&p.POSITION_CONTAINS):!n.contains(t));)d=n.parentNode,p.remove(n),n=d}}catch(e){}}function s(e,t){var n;for(e=e[t];e&&p.isFillChar(e);)n=e[t],p.remove(e),e=n}function l(e,t){var n,i,o=e.startContainer,r=e.endContainer,a=e.startOffset,s=e.endOffset,l=e.document,d=l.createDocumentFragment();if(1==o.nodeType&&(o=o.childNodes[a]||(n=o.appendChild(l.createTextNode("")))),1==r.nodeType&&(r=r.childNodes[s]||(i=r.appendChild(l.createTextNode("")))),o===r&&3==o.nodeType)return d.appendChild(l.createTextNode(o.substringData(a,s-a))),t&&(o.deleteData(a,s-a),e.collapse(!0)),d;for(var c,u,f=d,h=p.findParents(o,!0),m=p.findParents(r,!0),g=0;h[g]==m[g];)g++;for(var v,b=g;v=h[b];b++){for(c=v.nextSibling,v==o?n||(3==e.startContainer.nodeType?(f.appendChild(l.createTextNode(o.nodeValue.slice(a))),t&&o.deleteData(a,o.nodeValue.length-a)):f.appendChild(t?o:o.cloneNode(!0))):(u=v.cloneNode(!1),f.appendChild(u));c&&c!==r&&c!==m[b];)v=c.nextSibling,f.appendChild(t?c:c.cloneNode(!0)),c=v;f=u}f=d,h[g]||(f.appendChild(h[g-1].cloneNode(!1)),f=f.firstChild);for(var y,b=g;y=m[b];b++){if(c=y.previousSibling,y==r?i||3!=e.endContainer.nodeType||(f.appendChild(l.createTextNode(r.substringData(0,s))),t&&r.deleteData(0,s)):(u=y.cloneNode(!1),f.appendChild(u)),b!=g||!h[g])for(;c&&c!==o;)y=c.previousSibling,f.insertBefore(t?c:c.cloneNode(!0),f.firstChild),c=y;f=u}return t&&e.setStartBefore(m[g]?h[g]?m[g]:h[g-1]:m[g-1]).collapse(!0),n&&p.remove(n),i&&p.remove(i),d}var d,c=0,f=p.fillChar,h=o.Range=function(e,t){var n=this;n.startContainer=n.startOffset=n.endContainer=n.endOffset=null,n.document=e,n.collapsed=!0,n.body=t};h.prototype={deleteContents:function(){var e;return this.collapsed||l(this,1),a.webkit&&(e=this.startContainer,3!=e.nodeType||e.nodeValue.length||(this.setStartBefore(e).collapse(!0),p.remove(e))),this},inFillChar:function(){var e=this.startContainer;return!(!this.collapsed||3!=e.nodeType||e.nodeValue.replace(new RegExp("^"+p.fillChar),"").length+1!=e.nodeValue.length)},setStart:function(e,t){return i(!0,e,t,this)},setEnd:function(e,t){return i(!1,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,p.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,p.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,p.getNodeIndex(e)+1)},setEndBefore:function(e){return this.setEnd(e.parentNode,p.getNodeIndex(e))},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEndAtLast(e)},cloneRange:function(){var e=this;return new h(e.document).setStart(e.startContainer,e.startOffset).setEnd(e.endContainer,e.endOffset)},collapse:function(e){var t=this;return e?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(e){function t(e){return 1==e.nodeType&&!p.isBookmarkNode(e)&&!u.$empty[e.tagName]&&!u.$nonChild[e.tagName]}for(var n,i=this,o=i.collapsed;1==i.startContainer.nodeType&&(n=i.startContainer.childNodes[i.startOffset])&&t(n);)i.setStart(n,0);if(o)return i.collapse(!0);if(!e)for(;1==i.endContainer.nodeType&&i.endOffset>0&&(n=i.endContainer.childNodes[i.endOffset-1])&&t(n);)i.setEnd(n,n.childNodes.length);return i},trimBoundary:function(e){this.txtToElmBoundary();var t=this.startContainer,n=this.startOffset,i=this.collapsed,o=this.endContainer;if(3==t.nodeType){if(0==n)this.setStartBefore(t);else if(n>=t.nodeValue.length)this.setStartAfter(t);else{var r=p.split(t,n);t===o?this.setEnd(r,this.endOffset-n):t.parentNode===o&&(this.endOffset+=1),this.setStartBefore(r)}if(i)return this.collapse(!0)}return e||(n=this.endOffset,o=this.endContainer,3==o.nodeType&&(0==n?this.setEndBefore(o):(n<o.nodeValue.length&&p.split(o,n),this.setEndAfter(o)))),this},txtToElmBoundary:function(e){function t(e,t){var n=e[t+"Container"],i=e[t+"Offset"];3==n.nodeType&&(i?i>=n.nodeValue.length&&e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](n):e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](n))}return!e&&this.collapsed||(t(this,"start"),t(this,"end")),this},insertNode:function(e){var t=e,n=1;11==e.nodeType&&(t=e.firstChild,n=e.childNodes.length),this.trimBoundary(!0);var i=this.startContainer,o=this.startOffset,r=i.childNodes[o];return r?i.insertBefore(e,r):i.appendChild(e),t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+n),this.setStartBefore(t)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(e,t){var n,i=this.document.createElement("span");return i.style.cssText="display:none;line-height:0px;",i.appendChild(this.document.createTextNode("‍")),i.id="_baidu_bookmark_start_"+(t?"":c++),this.collapsed||(n=i.cloneNode(!0),n.id="_baidu_bookmark_end_"+(t?"":c++)),this.insertNode(i),n&&this.collapse().insertNode(n).setEndBefore(n),this.setStartAfter(i),{start:e?i.id:i,end:n?e?n.id:n:null,id:e}},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start,n=e.end&&e.id?this.document.getElementById(e.end):e.end;return this.setStartBefore(t),p.remove(t),n?(this.setEndBefore(n),p.remove(n)):this.collapse(!0),this},adjustmentBoundary:function(){if(!this.collapsed){for(;!p.isBody(this.startContainer)&&this.startOffset==this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length&&this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!p.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[3==this.endContainer.nodeType?"nodeValue":"childNodes"].length;)this.setEndBefore(this.endContainer)}return this},getClosedNode:function(){var e;if(!this.collapsed){var t=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(n(t)){var i=t.startContainer.childNodes[t.startOffset];i&&1==i.nodeType&&(u.$empty[i.tagName]||u.$nonChild[i.tagName])&&(e=i)}}return e},select:a.ie?function(e,t){var n;this.collapsed||this.shrinkBoundary();var i=this.getClosedNode();if(i&&!t){try{n=this.document.body.createControlRange(),n.addElement(i),n.select()}catch(e){}return this}var o,a=this.createBookmark(),l=a.start;if(n=this.document.body.createTextRange(),n.moveToElementText(l),n.moveStart("character",1),this.collapsed){if(!e&&3!=this.startContainer.nodeType){var c=this.document.createTextNode(f),u=this.document.createElement("span");u.appendChild(this.document.createTextNode(f)),l.parentNode.insertBefore(u,l),l.parentNode.insertBefore(c,l),r(this.document,c),d=c,s(u,"previousSibling"),s(l,"nextSibling"),n.moveStart("character",-1),n.collapse(!0)}}else{var h=this.document.body.createTextRange();o=a.end,h.moveToElementText(o),n.setEndPoint("EndToEnd",h)}this.moveToBookmark(a),u&&p.remove(u);try{n.select()}catch(e){}return this}:function(e){var t,n=p.getWindow(this.document),i=n.getSelection();if(a.gecko?this.body.focus():n.focus(),i){if(i.removeAllRanges(),this.collapsed&&!e){var o=this.startContainer,l=o;1==o.nodeType&&(l=o.childNodes[this.startOffset]),3==o.nodeType&&this.startOffset||(l?l.previousSibling&&3==l.previousSibling.nodeType:o.lastChild&&3==o.lastChild.nodeType)||(t=this.document.createTextNode(f),this.insertNode(t),r(this.document,t),s(t,"previousSibling"),s(t,"nextSibling"),d=t,this.setStart(t,a.webkit?1:0).collapse(!0))}var c=this.document.createRange();if(this.collapsed&&a.opera&&1==this.startContainer.nodeType){var l=this.startContainer.childNodes[this.startOffset];if(l){for(;l&&p.isBlockElm(l)&&1==l.nodeType&&l.childNodes[0];)l=l.childNodes[0];l&&this.setStartBefore(l).collapse(!0)}else(l=this.startContainer.lastChild)&&p.isBr(l)&&this.setStartBefore(l).collapse(!0)}!function(e){function t(t,n,i){3==t.nodeType&&t.nodeValue.length<n&&(e[i+"Offset"]=t.nodeValue.length)}t(e.startContainer,e.startOffset,"start"),t(e.endContainer,e.endOffset,"end")}(this),c.setStart(this.startContainer,this.startOffset),c.setEnd(this.endContainer,this.endOffset),i.addRange(c)}return this},createAddress:function(e,t){function n(e){for(var n,i=e?o.startContainer:o.endContainer,r=p.findParents(i,!0,function(e){return!p.isBody(e)}),a=[],s=0;n=r[s++];)a.push(p.getNodeIndex(n,t));var l=0;if(t)if(3==i.nodeType){for(var d=i.previousSibling;d&&3==d.nodeType;)l+=d.nodeValue.replace(m,"").length,d=d.previousSibling;l+=e?o.startOffset:o.endOffset}else if(i=i.childNodes[e?o.startOffset:o.endOffset])l=p.getNodeIndex(i,t);else{i=e?o.startContainer:o.endContainer;for(var c=i.firstChild;c;)if(p.isFillChar(c))c=c.nextSibling;else if(l++,3==c.nodeType)for(;c&&3==c.nodeType;)c=c.nextSibling;else c=c.nextSibling}else l=e?p.isFillChar(i)?0:o.startOffset:o.endOffset;return l<0&&(l=0),a.push(l),a}var i={},o=this;return i.startAddress=n(!0),e||(i.endAddress=o.collapsed?[].concat(i.startAddress):n()),i},moveToAddress:function(e,t){function n(e,t){for(var n,o,r,a=i.body,s=0,l=e.length;s<l;s++)if(r=e[s],n=a,!(a=a.childNodes[r])){o=r;break}t?a?i.setStartBefore(a):i.setStart(n,o):a?i.setEndBefore(a):i.setEnd(n,o)}var i=this;return n(e.startAddress,!0),!t&&e.endAddress&&n(e.endAddress),i},equals:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==e[t])return!1;return!0},scrollIntoView:function(){var t=e('<span style="padding:0;margin:0;display:block;border:0">&nbsp;</span>');this.cloneRange().insertNode(t.get(0));var n=e(window).scrollTop(),i=e(window).height(),o=t.offset().top;(o<n-i||o>n+i)&&(o>n+i?window.scrollTo(0,o-i+t.height()):window.scrollTo(0,n-o)),t.remove()},getOffset:function(){var t=this.createBookmark(),n=e(t.start).css("display","inline-block").offset();return this.moveToBookmark(t),n}}}(),function(){function t(e,t){var n=p.getNodeIndex;e=e.duplicate(),e.collapse(t);var i=e.parentElement();if(!i.hasChildNodes())return{container:i,offset:0};for(var o,r,a=i.children,s=e.duplicate(),l=0,d=a.length-1,c=-1;l<=d;){c=Math.floor((l+d)/2),o=a[c],s.moveToElementText(o);var f=s.compareEndPoints("StartToStart",e);if(f>0)d=c-1;else{if(!(f<0))return{container:i,offset:n(o)};l=c+1}}if(-1==c){if(s.moveToElementText(i),s.setEndPoint("StartToStart",e),r=s.text.replace(/(\r\n|\r)/g,"\n").length,a=i.childNodes,!r)return o=a[a.length-1],{container:o,offset:o.nodeValue.length};for(var h=a.length;r>0;)r-=a[--h].nodeValue.length;return{container:a[h],offset:-r}}if(s.collapse(f>0),s.setEndPoint(f>0?"StartToStart":"EndToStart",e),!(r=s.text.replace(/(\r\n|\r)/g,"\n").length))return u.$empty[o.tagName]||u.$nonChild[o.tagName]?{container:i,offset:n(o)+(f>0?0:1)}:{container:o,offset:f>0?0:o.childNodes.length};for(;r>0;)try{var m=o;o=o[f>0?"previousSibling":"nextSibling"],r-=o.nodeValue.length}catch(e){return{container:i,offset:n(m)}}return{container:o,offset:f>0?-r:o.nodeValue.length+r}}function n(e,n){if(e.item)n.selectNode(e.item(0));else{var i=t(e,!0);n.setStart(i.container,i.offset),0!=e.compareEndPoints("StartToEnd",e)&&(i=t(e,!1),n.setEnd(i.container,i.offset))}return n}function i(e,t){var n;try{n=e.getNative(t).createRange()}catch(e){return null}var i=n.item?n.item(0):n.parentElement();return(i.ownerDocument||i)===e.document?n:null}(o.Selection=function(t,n){var o=this;o.document=t,o.body=n,a.ie9below&&e(n).on("beforedeactivate",function(){o._bakIERange=o.getIERange()}).on("activate",function(){try{var e=i(o);e&&o.rangeInBody(e)||!o._bakIERange||o._bakIERange.select()}catch(e){}o._bakIERange=null})}).prototype={hasNativeRange:function(){var e;if(!a.ie||a.ie9above){var t=this.getNative();if(!t.rangeCount)return!1;e=t.getRangeAt(0)}else e=i(this);return this.rangeInBody(e)},getNative:function(e){var t=this.document;try{return t?a.ie9below||e?t.selection:p.getWindow(t).getSelection():null}catch(e){return null}},getIERange:function(e){var t=i(this,e);return t&&this.rangeInBody(t,e)||!this._bakIERange?t:this._bakIERange},rangeInBody:function(e,t){var n=a.ie9below||t?e.item?e.item():e.parentElement():e.startContainer;return n===this.body||p.inDoc(n,this.body)},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var e=this.getStart();return e?p.findParents(e,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){return this.hasNativeRange()},getRange:function(){function e(e){for(var n=t.body.firstChild,i=e.collapsed;n&&n.firstChild;)e.setStart(n,0),n=n.firstChild;e.startContainer||e.setStart(t.body,0),i&&e.collapse(!0)}var t=this;if(null!=t._cachedRange)return this._cachedRange;var i=new o.Range(t.document,t.body);if(a.ie9below){var r=t.getIERange();if(r&&this.rangeInBody(r))try{n(r,i)}catch(t){e(i)}else e(i)}else{var s=t.getNative();if(s&&s.rangeCount&&t.rangeInBody(s.getRangeAt(0))){var l=s.getRangeAt(0),d=s.getRangeAt(s.rangeCount-1);i.setStart(l.startContainer,l.startOffset).setEnd(d.endContainer,d.endOffset),i.collapsed&&p.isBody(i.startContainer)&&!i.startOffset&&e(i)}else{if(this._bakRange&&(this._bakRange.startContainer===this.body||p.inDoc(this._bakRange.startContainer,this.body)))return this._bakRange;e(i)}}return this._bakRange=i},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var e,t,n,i,o=a.ie9below?this.getIERange():this.getRange();if(a.ie9below){if(!o)return this.document.body.firstChild;if(o.item)return o.item(0);for(e=o.duplicate(),e.text.length>0&&e.moveStart("character",1),e.collapse(1),t=e.parentElement(),i=n=o.parentElement();n=n.parentNode;)if(n==t){t=i;break}}else if(t=o.startContainer,1==t.nodeType&&t.hasChildNodes()&&(t=t.childNodes[Math.min(t.childNodes.length-1,o.startOffset)]),3==t.nodeType)return t.parentNode;return t},getText:function(){var e,t;return this.isFocus()&&(e=this.getNative())?(t=a.ie9below?e.createRange():e.getRangeAt(0),a.ie9below?t.text:t.toString()):""}}}(),function(){function t(e,t){var n;if(t.textarea)if(d.isString(t.textarea)){for(var i,o=0,r=p.getElementsByTagName(e,"textarea");i=r[o++];)if(i.id=="umeditor_textarea_"+t.options.textarea){n=i;break}}else n=t.textarea;n||(e.appendChild(n=p.createElement(document,"textarea",{name:t.options.textarea,id:"umeditor_textarea_"+t.options.textarea,style:"display:none"})),t.textarea=n),n.value=t.hasContents()?t.options.allHtmlEnabled?t.getAllHtml():t.getContent(null,null,!0):""}function n(e){for(var t in UM.plugins)-1==e.options.excludePlugins.indexOf(t)&&(UM.plugins[t].call(e),e.plugins[t]=1);e.langIsReady=!0,e.fireEvent("langReady")}function i(e){for(var t in e)return t}var r,s=0,f=UM.Editor=function(e){var t=this;t.uid=s++,c.call(t),t.commands={},t.options=d.extend(d.clone(e||{}),UMEDITOR_CONFIG,!0),t.shortcutkeys={},t.inputRules=[],t.outputRules=[],t.setOpt({isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,enterTag:"p",lang:"zh-cn",langPath:t.options.UMEDITOR_HOME_URL+"lang/",theme:"default",themePath:t.options.UMEDITOR_HOME_URL+"themes/",allHtmlEnabled:!1,autoSyncData:!0,autoHeightEnabled:!0,excludePlugins:""}),t.plugins={},d.isEmptyObject(UM.I18N)?d.loadFile(document,{src:t.options.langPath+t.options.lang+"/"+t.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){n(t)}):(t.options.lang=i(UM.I18N),n(t))};f.prototype={ready:function(e){var t=this;e&&(t.isReady?e.apply(t):t.addListener("ready",e))},setOpt:function(e,t){var n={};d.isString(e)?n[e]=t:n=e,d.extend(this.options,n,!0)},getOpt:function(e){return this.options[e]||""},destroy:function(){var t=this;t.fireEvent("destroy");var n=t.container.parentNode;n===document.body&&(n=t.container);var i=t.textarea;i?i.style.display="":(i=document.createElement("textarea"),n.parentNode.insertBefore(i,n)),i.style.width=t.body.offsetWidth+"px",i.style.height=t.body.offsetHeight+"px",i.value=t.getContent(),i.id=t.key,n.contains(i)&&e(i).insertBefore(n),n.innerHTML="",p.remove(n),UM.clearCache(t.id);for(var o in t)t.hasOwnProperty(o)&&delete this[o]},initialCont:function(e){if(e){if(e.getAttribute("name")&&(this.options.textarea=e.getAttribute("name")),e&&/script|textarea/gi.test(e.tagName)){var t=document.createElement("div");e.parentNode.insertBefore(t,e),this.options.initialContent=UM.htmlparser(e.value||e.innerHTML||this.options.initialContent).toHtml(),e.className&&(t.className=e.className),e.style.cssText&&(t.style.cssText=e.style.cssText),/textarea/i.test(e.tagName)?(this.textarea=e,this.textarea.style.display="none"):(e.parentNode.removeChild(e),e.id&&(t.id=e.id)),e=t,e.innerHTML=""}return e}return null},render:function(t){var n=this,i=n.options,o=function(n){return parseInt(e(t).css(n))};if(d.isString(t)&&(t=document.getElementById(t)),t){this.id=t.getAttribute("id"),UM.setEditor(this),d.cssRule("edui-style-body",n.options.initialStyle,document),t=this.initialCont(t),t.className+=" edui-body-container",i.initialFrameWidth?i.minFrameWidth=i.initialFrameWidth:i.minFrameWidth=i.initialFrameWidth=e(t).width()||UM.defaultWidth,i.initialFrameHeight?i.minFrameHeight=i.initialFrameHeight:i.initialFrameHeight=i.minFrameHeight=e(t).height()||UM.defaultHeight,t.style.width=/%$/.test(i.initialFrameWidth)?"100%":i.initialFrameWidth-o("padding-left")-o("padding-right")+"px";var r=/%$/.test(i.initialFrameHeight)?"100%":i.initialFrameHeight-o("padding-top")-o("padding-bottom");this.options.autoHeightEnabled?(t.style.minHeight=r+"px",t.style.height="",a.ie&&a.version<=6&&(t.style.height=r,t.style.setExpression("height","this.scrollHeight <= "+r+' ? "'+r+'px" : "auto"'))):e(t).height(r),t.style.zIndex=i.zIndex,this._setup(t)}},_setup:function(n){var i=this,r=i.options;n.contentEditable=!0,document.body.spellcheck=!1,i.document=document,i.window=document.defaultView||document.parentWindow,i.body=n,i.$body=e(n),i.selection=new o.Selection(document,i.body),i._isEnabled=!1;var s;a.gecko&&(s=this.selection.getNative())&&s.removeAllRanges(),this._initEvents();for(var l=n.parentNode;l&&!p.isBody(l);l=l.parentNode)if("FORM"==l.tagName){i.form=l,i.options.autoSyncData?e(n).on("blur",function(){t(l,i)}):e(l).on("submit",function(){t(this,i)});break}if(r.initialContent)if(r.autoClearinitialContent){var d=i.execCommand;i.execCommand=function(){return i.fireEvent("firstBeforeExecCommand"),d.apply(i,arguments)},this._setDefaultContent(r.initialContent)}else this.setContent(r.initialContent,!1,!0);p.isEmptyNode(i.body)&&(i.body.innerHTML="<p>"+(a.ie?"":"<br/>")+"</p>"),r.focus&&setTimeout(function(){i.focus(i.options.focusInEnd),!i.options.autoClearinitialContent&&i._selectionChange()},0),i.container||(i.container=n.parentNode),i._bindshortcutKeys(),i.isReady=1,i.fireEvent("ready"),r.onready&&r.onready.call(i),a.ie&&!a.ie9above||e(i.body).on("blur focus",function(e){var t=i.selection.getNative();if("blur"==e.type)t.rangeCount>0&&(i._bakRange=t.getRangeAt(0));else{try{i._bakRange&&t.addRange(i._bakRange)}catch(e){}i._bakRange=null}}),!r.isShow&&i.setHide(),r.readonly&&i.setDisabled()},sync:function(e){var n=this,i=e?document.getElementById(e):p.findParent(n.body.parentNode,function(e){return"FORM"==e.tagName},!0);i&&t(i,n)},setHeight:function(t,n){!n&&(this.options.initialFrameHeight=t),this.options.autoHeightEnabled?(e(this.body).css({"min-height":t+"px"}),a.ie&&a.version<=6&&this.container&&(this.container.style.height=t,this.container.style.setExpression("height","this.scrollHeight <= "+t+' ? "'+t+'px" : "auto"'))):e(this.body).height(t),this.fireEvent("resize")},setWidth:function(t){this.$container&&this.$container.width(t),e(this.body).width(t-1*e(this.body).css("padding-left").replace("px","")-1*e(this.body).css("padding-right").replace("px","")),this.fireEvent("resize")},addshortcutkey:function(e,t){var n={};t?n[e]=t:n=e,d.extend(this.shortcutkeys,n)},_bindshortcutKeys:function(){var e=this,t=this.shortcutkeys;e.addListener("keydown",function(n,i){var o=i.keyCode||i.which;for(var r in t)for(var a,s=t[r].split(","),l=0;a=s[l++];){a=a.split(":");var d=a[0],c=a[1];(/^(ctrl)(\+shift)?\+(\d+)$/.test(d.toLowerCase())||/^(\d+)$/.test(d))&&(("ctrl"==RegExp.$1?i.ctrlKey||i.metaKey:0)&&(""!=RegExp.$2?i[RegExp.$2.slice(1)+"Key"]:1)&&o==RegExp.$3||o==RegExp.$1)&&(-1!=e.queryCommandState(r,c)&&e.execCommand(r,c),p.preventDefault(i))}})},getContent:function(e,t,n,i,o){var r=this;if(e&&d.isFunction(e)&&(t=e,e=""),t?!t():!this.hasContents())return"";r.fireEvent("beforegetcontent");var a=UM.htmlparser(r.body.innerHTML,i);return r.filterOutputRule(a),r.fireEvent("aftergetcontent",a),a.toHtml(o)},getAllHtml:function(){var e=this,t=[];if(e.fireEvent("getAllHtml",t),a.ie&&a.version>8){var n="";d.each(e.document.styleSheets,function(e){n+=e.href?'<link rel="stylesheet" type="text/css" href="'+e.href+'" />':"<style>"+e.cssText+"</style>"}),d.each(e.document.getElementsByTagName("script"),function(e){n+=e.outerHTML})}return"<html><head>"+(e.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+e.options.charset+'"/>':"")+(n||e.document.getElementsByTagName("head")[0].innerHTML)+t.join("\n")+"</head><body "+(l&&a.version<9?'class="view"':"")+">"+e.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var e=new RegExp(p.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");return t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>\/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(e,t,n){return u.$block[n]?"\n":t||""}),t.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var e=new RegExp(p.fillChar,"g");return this.body[a.ie?"innerText":"textContent"].replace(e,"").replace(/\u00a0/g," ")},setContent:function(e,n,i){var o=this;o.fireEvent("beforesetcontent",e);var r=UM.htmlparser(e);if(o.filterInputRule(r),e=r.toHtml(),o.body.innerHTML=(n?o.body.innerHTML:"")+e,"p"==o.options.enterTag){var s,l=this.body.firstChild;if(!l||1==l.nodeType&&(u.$cdata[l.tagName]||function(e){return"DIV"==e.tagName&&e.getAttribute("cdata_tag")}(l)||p.isCustomeNode(l))&&l===this.body.lastChild)this.body.innerHTML="<p>"+(a.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else for(var d=o.document.createElement("p");l;){for(;l&&(3==l.nodeType||1==l.nodeType&&u.p[l.tagName]&&!u.$cdata[l.tagName]);)s=l.nextSibling,d.appendChild(l),l=s;if(d.firstChild){if(!l){o.body.appendChild(d);break}l.parentNode.insertBefore(d,l),d=o.document.createElement("p")}l=l.nextSibling}}o.fireEvent("aftersetcontent"),o.fireEvent("contentchange"),!i&&o._selectionChange(),o._bakRange=o._bakIERange=o._bakNativeRange=null;var c;a.gecko&&(c=this.selection.getNative())&&c.removeAllRanges(),o.options.autoSyncData&&o.form&&t(o.form,o)},focus:function(e){try{var t=this,n=t.selection.getRange();e?n.setStartAtLast(t.body.lastChild).setCursor(!1,!0):n.select(!0),this.fireEvent("focus")}catch(e){}},blur:function(){var e=this.selection.getNative();e.empty?e.empty():e.removeAllRanges(),this.fireEvent("blur")},isFocus:function(){return!0===this.fireEvent("isfocus")||this.selection.isFocus()},_initEvents:function(){var t=this,n=t.body,i=function(){t._proxyDomEvent.apply(t,arguments)};e(n).on("click contextmenu mousedown keydown keyup keypress mouseup mouseover mouseout selectstart",i).on("focus blur",i).on("mouseup keydown",function(e){"keydown"==e.type&&(e.ctrlKey||e.metaKey||e.shiftKey||e.altKey)||2!=e.button&&t._selectionChange(250,e)})},_proxyDomEvent:function(e){return this.fireEvent(e.type.replace(/^on/,""),e)},_selectionChange:function(e,t){var n,i,o=this,s=!1;if(a.ie&&a.version<9&&t&&"mouseup"==t.type){this.selection.getRange().collapsed||(s=!0,n=t.clientX,i=t.clientY)}clearTimeout(r),r=setTimeout(function(){if(o.selection.getNative()){var e;if(s&&"None"==o.selection.getNative().type){e=o.document.body.createTextRange();try{e.moveToPoint(n,i)}catch(t){e=null}}var r;e&&(r=o.selection.getIERange,o.selection.getIERange=function(){return e}),o.selection.cache(),r&&(o.selection.getIERange=r),o.selection._cachedRange&&o.selection._cachedStartElement&&(o.fireEvent("beforeselectionchange"),o.fireEvent("selectionchange",!!t),o.fireEvent("afterselectionchange"),o.selection.clear())}},e||50)},_callCmdFn:function(e,t){t=Array.prototype.slice.call(t,0);var n,i,o=t.shift().toLowerCase();return n=this.commands[o]||UM.commands[o],i=n&&n[e],n&&i||"queryCommandState"!=e?i?i.apply(this,[o].concat(t)):void 0:0},execCommand:function(e){if(!this.isFocus()){var t=this.selection._bakRange;t?t.select():this.focus(!0)}e=e.toLowerCase();var n,i=this,o=i.commands[e]||UM.commands[e];return o&&o.execCommand?(o.notNeedUndo||i.__hasEnterExecCommand?(n=this._callCmdFn("execCommand",arguments),!i.__hasEnterExecCommand&&!o.ignoreContentChange&&!i._ignoreContentChange&&i.fireEvent("contentchange")):(i.__hasEnterExecCommand=!0,-1!=i.queryCommandState.apply(i,arguments)&&(i.fireEvent("saveScene"),i.fireEvent("beforeexeccommand",e),n=this._callCmdFn("execCommand",arguments),!o.ignoreContentChange&&!i._ignoreContentChange&&i.fireEvent("contentchange"),i.fireEvent("afterexeccommand",e),i.fireEvent("saveScene")),i.__hasEnterExecCommand=!1),!i.__hasEnterExecCommand&&!o.ignoreContentChange&&!i._ignoreContentChange&&i._selectionChange(),n):null},queryCommandState:function(e){try{return this._callCmdFn("queryCommandState",arguments)}catch(e){return 0}},queryCommandValue:function(e){try{return this._callCmdFn("queryCommandValue",arguments)}catch(e){return null}},hasContents:function(e){if(e)for(var t,n=0;t=e[n++];)if(this.body.getElementsByTagName(t).length>0)return!0;if(!p.isEmptyBlock(this.body))return!0;for(e=["div"],n=0;t=e[n++];)for(var i,o=p.getElementsByTagName(this.body,t),r=0;i=o[r++];)if(p.isCustomeNode(i))return!0;return!1},reset:function(){this.fireEvent("reset")},isEnabled:function(){return 1!=this._isEnabled},setEnabled:function(){var e,t=this;if(t.body.contentEditable=!0,t.lastBk){e=t.selection.getRange();try{e.moveToBookmark(t.lastBk),delete t.lastBk}catch(n){e.setStartAtFirst(t.body).collapse(!0)}e.select(!0)}t.bkqueryCommandState&&(t.queryCommandState=t.bkqueryCommandState,delete t.bkqueryCommandState),t._bkproxyDomEvent&&(t._proxyDomEvent=t._bkproxyDomEvent,delete t._bkproxyDomEvent),t.fireEvent("setEnabled")},enable:function(){return this.setEnabled()},setDisabled:function(e,t){var n=this;n.body.contentEditable=!1,n._except=e?d.isArray(e)?e:[e]:[],n.lastBk||(n.lastBk=n.selection.getRange().createBookmark(!0)),n.bkqueryCommandState||(n.bkqueryCommandState=n.queryCommandState,n.queryCommandState=function(e){return-1!=d.indexOf(n._except,e)?n.bkqueryCommandState.apply(n,arguments):-1}),t||n._bkproxyDomEvent||(n._bkproxyDomEvent=n._proxyDomEvent,n._proxyDomEvent=function(){return!1}),n.fireEvent("selectionchange"),n.fireEvent("setDisabled",n._except)},disable:function(e){return this.setDisabled(e)},_setDefaultContent:function(){function e(){var t=this;t.document.getElementById("initContent")&&(t.body.innerHTML="<p>"+(l?"":"<br/>")+"</p>",t.removeListener("firstBeforeExecCommand focus",e),setTimeout(function(){t.focus(),t._selectionChange()},0))}return function(t){var n=this;n.body.innerHTML='<p id="initContent">'+t+"</p>",n.addListener("firstBeforeExecCommand focus",e)}}(),setShow:function(){var e=this,t=e.selection.getRange();if("none"==e.container.style.display){try{t.moveToBookmark(e.lastBk),delete e.lastBk}catch(n){t.setStartAtFirst(e.body).collapse(!0)}setTimeout(function(){t.select(!0)},100),e.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var e=this;e.lastBk||(e.lastBk=e.selection.getRange().createBookmark(!0)),e.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(e){var t=UM.I18N[this.options.lang];if(!t)throw Error("not import language file");e=(e||"").split(".");for(var n,i=0;(n=e[i++])&&(t=t[n]););return t},getContentLength:function(e,t){var n=this.getContent(!1,!1,!0).length;if(e){t=(t||[]).concat(["hr","img","iframe"]),n=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var i,o=0;i=t[o++];)n+=this.body.getElementsByTagName(i).length}return n},addInputRule:function(e,t){e.ignoreUndo=t,this.inputRules.push(e)},filterInputRule:function(e,t){for(var n,i=0;n=this.inputRules[i++];)t&&n.ignoreUndo||n.call(this,e)},addOutputRule:function(e,t){e.ignoreUndo=t,this.outputRules.push(e)},filterOutputRule:function(e,t){for(var n,i=0;n=this.outputRules[i++];)t&&n.ignoreUndo||n.call(this,e)}},d.inherits(f,c)}();UM.filterWord=function(){function e(e){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/gi.test(e)}function t(e){return e=e.replace(/[\d.]+\w+/g,function(e){return d.transUnitToPx(e)})}function n(e){return e.replace(/[\t\r\n]+/g," ").replace(/<!--[\s\S]*?-->/gi,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(e){if(a.opera)return"";try{if(/Bitmap/i.test(e))return"";var n=e.match(/width:([ \d.]*p[tx])/i)[1],i=e.match(/height:([ \d.]*p[tx])/i)[1],o=e.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+t(n)+'" height="'+t(i)+'" src="'+o+'" />'}catch(e){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/gi,function(e,t,n,i){return"class"==t&&"MsoListParagraph"==i?e:""}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,function(e,t,n){return n.replace(/[\t\r\n ]+/g," ")}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(e,n,i,o){for(var r,a=[],s=o.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").split(/;\s*/g),l=0;r=s[l];l++){var d,c,u=r.split(":");if(2==u.length){if(d=u[0].toLowerCase(),c=u[1].toLowerCase(),/^(background)\w*/.test(d)&&0==c.replace(/(initial|\s)/g,"").length||/^(margin)\w*/.test(d)&&/^0\w+$/.test(c))continue;switch(d){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(n)||(a[l]=d.replace(/^mso-|-alt$/g,"")+":"+t(c));continue;case"horiz-align":a[l]="text-align:"+c;continue;case"vert-align":a[l]="vertical-align:"+c;continue;case"font-color":case"mso-foreground":a[l]="color:"+c;continue;case"mso-background":case"mso-highlight":a[l]="background:"+c;continue;case"mso-default-height":a[l]="min-height:"+t(c);continue;case"mso-default-width":a[l]="min-width:"+t(c);continue;case"mso-padding-between-alt":a[l]="border-collapse:separate;border-spacing:"+t(c);continue;case"text-line-through":"single"!=c&&"double"!=c||(a[l]="text-decoration:line-through");continue;case"mso-zero-height":"yes"==c&&(a[l]="display:none");continue;case"margin":if(!/[1-9]/.test(c))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(d)||/text\-indent|padding|margin/.test(d)&&/\-[\d.]+/.test(c))continue;a[l]=d+":"+u[1]}}return n+(a.length?' style="'+a.join(";").replace(/;{2,}/g,";")+'"':"")}).replace(/[\d.]+(cm|pt)/g,function(e){return d.transUnitToPx(e)})}return function(t){return e(t)?n(t):t}}();!function(){function t(e,t,n){return e.push(g),t+(n?1:-1)}function n(e,t){for(var n=0;n<t;n++)e.push(m)}function i(e,s,l,d){switch(e.type){case"root":for(var c,f=0;c=e.children[f++];)l&&"element"==c.type&&!u.$inlineWithA[c.tagName]&&f>1&&(t(s,d,!0),n(s,d)),i(c,s,l,d);break;case"text":o(e,s);break;case"element":r(e,s,l,d);break;case"comment":a(e,s)}return s}function o(e,t){"pre"==e.parentNode.tagName?t.push(e.data):t.push(p[e.parentNode.tagName]?d.html(e.data):e.data.replace(/[ ]{2}/g," &nbsp;"))}function r(e,o,r,a){var s="";if(e.attrs){s=[];var l=e.attrs;for(var c in l)s.push(c+(void 0!==l[c]?'="'+(h[c]?d.html(l[c]).replace(/["]/g,function(e){return"&quot;"}):d.unhtml(l[c]))+'"':""));s=s.join(" ")}if(o.push("<"+e.tagName+(s?" "+s:"")+(u.$empty[e.tagName]?"/":"")+">"),r&&!u.$inlineWithA[e.tagName]&&"pre"!=e.tagName&&e.children&&e.children.length&&(a=t(o,a,!0),n(o,a)),e.children&&e.children.length)for(var f,p=0;f=e.children[p++];)r&&"element"==f.type&&!u.$inlineWithA[f.tagName]&&p>1&&(t(o,a),n(o,a)),i(f,o,r,a);u.$empty[e.tagName]||(r&&!u.$inlineWithA[e.tagName]&&"pre"!=e.tagName&&e.children&&e.children.length&&(a=t(o,a),n(o,a)),o.push("</"+e.tagName+">"))}function a(e,t){t.push("\x3c!--"+e.data+"--\x3e")}function s(e,t){var n;if("element"==e.type&&e.getAttr("id")==t)return e;if(e.children&&e.children.length)for(var i,o=0;i=e.children[o++];)if(n=s(i,t))return n}function l(e,t,n){if("element"==e.type&&e.tagName==t&&n.push(e),e.children&&e.children.length)for(var i,o=0;i=e.children[o++];)l(i,t,n)}function c(e,t){if(e.children&&e.children.length)for(var n,i=0;n=e.children[i];)c(n,t),n.parentNode&&(n.children&&n.children.length&&t(n),n.parentNode&&i++);else t(e)}var f=UM.uNode=function(e){this.type=e.type,this.data=e.data,this.tagName=e.tagName,this.parentNode=e.parentNode,this.attrs=e.attrs||{},this.children=e.children},h={href:1,src:1,_src:1,_href:1,cdata_data:1},p={style:1,script:1},m="    ",g="\n";f.createElement=function(e){return/[<>]/.test(e)?UM.htmlparser(e).children[0]:new f({type:"element",children:[],tagName:e})},f.createText=function(e,t){return new UM.uNode({type:"text",data:t?e:d.unhtml(e||"")})},f.prototype={toHtml:function(e){var t=[];return i(this,t,e,0),t.join("")},innerHTML:function(e){if("element"!=this.type||u.$empty[this.tagName])return this;if(d.isString(e)){if(this.children)for(var t,n=0;t=this.children[n++];)t.parentNode=null;this.children=[];for(var t,i=UM.htmlparser(e),n=0;t=i.children[n++];)this.children.push(t),t.parentNode=this;return this}var i=new UM.uNode({type:"root",children:this.children});return i.toHtml()},innerText:function(e,t){if("element"!=this.type||u.$empty[this.tagName])return this;if(e){if(this.children)for(var n,i=0;n=this.children[i++];)n.parentNode=null;return this.children=[],this.appendChild(f.createText(e,t)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return"element"==this.type?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var e,t=this.parentNode,n=0;e=t.children[n];n++)if(e===this)return 0==n?null:t.children[n-1]},nextSibling:function(){for(var e,t=this.parentNode,n=0;e=t.children[n++];)if(e===this)return t.children[n]},replaceChild:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i,1,e),t.parentNode=null,e.parentNode=this,e}},appendChild:function(e){if("root"==this.type||"element"==this.type&&!u.$empty[this.tagName]){this.children||(this.children=[]),e.parentNode&&e.parentNode.removeChild(e);for(var t,n=0;t=this.children[n];n++)if(t===e){this.children.splice(n,1);break}return this.children.push(e),e.parentNode=this,e}},insertBefore:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i,0,e),e.parentNode=this,e}},insertAfter:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i+1,0,e),e.parentNode=this,e}},removeChild:function(e,t){if(this.children)for(var n,i=0;n=this.children[i];i++)if(n===e){if(this.children.splice(i,1),n.parentNode=null,t&&n.children&&n.children.length)for(var o,r=0;o=n.children[r];r++)this.children.splice(i+r,0,o),o.parentNode=this;return n}},getAttr:function(e){return this.attrs&&this.attrs[e.toLowerCase()]},setAttr:function(e,t){if(!e)return void delete this.attrs;if(this.attrs||(this.attrs={}),d.isObject(e))for(var n in e)e[n]?this.attrs[n.toLowerCase()]=e[n]:delete this.attrs[n];else t?this.attrs[e.toLowerCase()]=t:delete this.attrs[e]},hasAttr:function(e){var t=this.getAttr(e);return null!==t&&void 0!==t},getIndex:function(){for(var e,t=this.parentNode,n=0;e=t.children[n];n++)if(e===this)return n;return-1},getNodeById:function(e){var t;if(this.children&&this.children.length)for(var n,i=0;n=this.children[i++];)if(t=s(n,e))return t},getNodesByTagName:function(e){e=d.trim(e).replace(/[ ]{2,}/g," ").split(" ");var t=[],n=this;return d.each(e,function(e){if(n.children&&n.children.length)for(var i,o=0;i=n.children[o++];)l(i,e,t)}),t},getStyle:function(e){var t=this.getAttr("style");if(!t)return"";var n=new RegExp("(^|;)\\s*"+e+":([^;]+)","i"),i=t.match(n);return i&&i[0]?i[2]:""},setStyle:function(e,t){function n(e,t){var n=new RegExp("(^|;)\\s*"+e+":([^;]+;?)","gi");i=i.replace(n,"$1"),t&&(i=e+":"+d.unhtml(t)+";"+i)}var i=this.getAttr("style");if(i||(i=""),d.isObject(e))for(var o in e)n(o,e[o]);else n(e,t);this.setAttr("style",d.trim(i))},hasClass:function(t){if(this.hasAttr("class")){var n=this.getAttr("class").split(/\s+/),i=!1;return e.each(n,function(e,n){n===t&&(i=!0)}),i}return!1},addClass:function(e){var t=null,n=!1;this.hasAttr("class")?(t=this.getAttr("class"),t=t.split(/\s+/),t.forEach(function(t){if(t===e)return void(n=!0)}),!n&&t.push(e),this.setAttr("class",t.join(" "))):this.setAttr("class",e)},removeClass:function(e){if(this.hasAttr("class")){var t=this.getAttr("class");t=t.replace(new RegExp("\\b"+e+"\\b","g"),""),this.setAttr("class",d.trim(t).replace(/[ ]{2,}/g," "))}},traversal:function(e){return this.children&&this.children.length&&c(this,e),this}}}();UM.htmlparser=function(e,t){function n(e,t){if(h[e.tagName]){var n=c.createElement(h[e.tagName]);e.appendChild(n),n.appendChild(c.createText(t)),e=n}else e.appendChild(c.createText(t))}function i(e,t,n){var o;if(o=f[t]){for(var a,s=e;"root"!=s.type;){if(d.isArray(o)?-1!=d.indexOf(o,s.tagName):o==s.tagName){e=s,a=!0;break}s=s.parentNode}a||(e=i(e,d.isArray(o)?o[0]:o))}var h=new c({parentNode:e,type:"element",tagName:t.toLowerCase(),children:u.$empty[t]?null:[]});if(n){for(var p,m={};p=r.exec(n);)m[p[1].toLowerCase()]=l[p[1].toLowerCase()]?p[2]||p[3]||p[4]:d.unhtml(p[2]||p[3]||p[4]);h.attrs=m}return e.children.push(h),u.$empty[t]?e:h}var o=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,r=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,a={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};e=e.replace(new RegExp(p.fillChar,"g"),""),t||(e=e.replace(new RegExp("[\\r\\t\\n"+(t?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(t?"":" ")+"]*","g"),function(e,n){return n&&a[n.toLowerCase()]?e.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):e.replace(new RegExp("^[\\r\\n"+(t?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(t?"":" ")+"]+$"),"")}));for(var s,l={href:1,src:1},c=UM.uNode,f={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},h={ol:"li",ul:"li"},m=0,g=0,v=new c({type:"root",children:[]}),b=v;s=o.exec(e);){m=s.index;try{if(m>g&&n(b,e.slice(g,m)),s[3])u.$cdata[b.tagName]?n(b,s[0]):b=i(b,s[3].toLowerCase(),s[4]);else if(s[1]){if("root"!=b.type)if(u.$cdata[b.tagName]&&!u.$cdata[s[1]])n(b,s[0]);else{for(var y=b;"element"==b.type&&b.tagName!=s[1].toLowerCase();)if(b=b.parentNode,"root"==b.type)throw b=y,"break";b=b.parentNode}}else s[2]&&function(e,t){e.children.push(new c({type:"comment",data:t,parentNode:e}))}(b,s[2])}catch(e){}g=o.lastIndex}return g<e.length&&n(b,e.slice(g)),v},UM.filterNode=function(){function e(t,n){switch(t.type){case"text":break;case"element":var i;if(i=n[t.tagName])if("-"===i)t.parentNode.removeChild(t);else if(d.isFunction(i)){var o=t.parentNode,r=t.getIndex();if(i(t),t.parentNode){if(t.children)for(var a,s=0;a=t.children[s];)e(a,n),a.parentNode&&s++}else for(var a,s=r;a=o.children[s];)e(a,n),a.parentNode&&s++}else{var l=i.$;if(l&&t.attrs){var c,f={};for(var h in l){if(c=t.getAttr(h),"style"==h&&d.isArray(l[h])){var p=[];d.each(l[h],function(e){var n;(n=t.getStyle(e))&&p.push(e+":"+n)}),c=p.join(";")}c&&(f[h]=c)}t.attrs=f}if(t.children)for(var a,s=0;a=t.children[s];)e(a,n),a.parentNode&&s++}else if(u.$cdata[t.tagName])t.parentNode.removeChild(t);else{var o=t.parentNode,r=t.getIndex();t.parentNode.removeChild(t,!0);for(var a,s=r;a=o.children[s];)e(a,n),a.parentNode&&s++}break;case"comment":t.parentNode.removeChild(t)}}return function(t,n){if(d.isEmptyObject(n))return t;var i;(i=n["-"])&&d.each(i.split(" "),function(e){n[e]="-"});for(var o,r=0;o=t.children[r];)e(o,n),o.parentNode&&r++;return t}}();UM.commands.inserthtml={execCommand:function(e,t,n){var i,o,r=this;if(t&&!0!==r.fireEvent("beforeinserthtml",t)){if(i=r.selection.getRange(),o=i.document.createElement("div"),o.style.display="inline",!n){var s=UM.htmlparser(t);r.options.filterRules&&UM.filterNode(s,r.options.filterRules),r.filterInputRule(s),t=s.toHtml()}if(o.innerHTML=d.trim(t),!i.collapsed){var l=i.startContainer;if(p.isFillChar(l)&&i.setStartBefore(l),l=i.endContainer,p.isFillChar(l)&&i.setEndAfter(l),i.txtToElmBoundary(),i.endContainer&&1==i.endContainer.nodeType&&(l=i.endContainer.childNodes[i.endOffset])&&p.isBr(l)&&i.setEndAfter(l),0==i.startOffset&&(l=i.startContainer,p.isBoundaryNode(l,"firstChild")&&(l=i.endContainer,i.endOffset==(3==l.nodeType?l.nodeValue.length:l.childNodes.length)&&p.isBoundaryNode(l,"lastChild")&&(r.body.innerHTML="<p>"+(a.ie?"":"<br/>")+"</p>",i.setStart(r.body.firstChild,0).collapse(!0)))),!i.collapsed&&i.deleteContents(),1==i.startContainer.nodeType){var c,f=i.startContainer.childNodes[i.startOffset];if(f&&p.isBlockElm(f)&&(c=f.previousSibling)&&p.isBlockElm(c)){for(i.setEnd(c,c.childNodes.length).collapse();f.firstChild;)c.appendChild(f.firstChild);p.remove(f)}}}var f,h,c,g,v,b=0;for(i.inFillChar()&&(f=i.startContainer,p.isFillChar(f)?(i.setStartBefore(f).collapse(!0),p.remove(f)):p.isFillChar(f,!0)&&(f.nodeValue=f.nodeValue.replace(m,""),i.startOffset--,i.collapsed&&i.collapse(!0)));f=o.firstChild;){if(b){for(var y=r.document.createElement("p");f&&(3==f.nodeType||!u.$block[f.tagName]);)v=f.nextSibling,y.appendChild(f),f=v;y.firstChild&&(f=y)}if(i.insertNode(f),v=f.nextSibling,!b&&f.nodeType==p.NODE_ELEMENT&&p.isBlockElm(f)&&(h=p.findParent(f,function(e){return p.isBlockElm(e)}))&&"body"!=h.tagName.toLowerCase()&&(!u[h.tagName][f.nodeName]||f.parentNode!==h)){if(u[h.tagName][f.nodeName])for(g=f.parentNode;g!==h;)c=g,g=g.parentNode;else c=h;p.breakParent(f,c||g);var c=f.previousSibling;p.trimWhiteTextNode(c),c.childNodes.length||p.remove(c),!a.ie&&(C=f.nextSibling)&&p.isBlockElm(C)&&C.lastChild&&!p.isBr(C.lastChild)&&C.appendChild(r.document.createElement("br")),b=1}var C=f.nextSibling;if(!o.firstChild&&C&&p.isBlockElm(C)){i.setStart(C,0).collapse(!0);break}i.setEndAfter(f).collapse()}if(f=i.startContainer,v&&p.isBr(v)&&p.remove(v),p.isBlockElm(f)&&p.isEmptyNode(f))if(v=f.nextSibling)p.remove(f),1==v.nodeType&&u.$block[v.tagName]&&i.setStart(v,0).collapse(!0).shrinkBoundary();else try{f.innerHTML=a.ie?p.fillChar:"<br/>"}catch(e){i.setStartBefore(f),p.remove(f)}try{if(a.ie9below&&1==i.startContainer.nodeType&&!i.startContainer.childNodes[i.startOffset]){var x=i.startContainer,c=x.childNodes[i.startOffset-1];if(c&&1==c.nodeType&&u.$empty[c.tagName]){var N=this.document.createTextNode(p.fillChar);i.insertNode(N).setStart(N,0).collapse(!0)}}setTimeout(function(){i.select(!0)})}catch(e){}setTimeout(function(){i=r.selection.getRange(),i.scrollIntoView(),r.fireEvent("afterinserthtml")},200)}}},UM.commands.insertimage={execCommand:function(e,t){if(t=d.isArray(t)?t:[t],t.length){var n,i=this,o=[],r="";if(n=t[0],1==t.length)r='<img src="'+n.src+'" '+(n._src?' _src="'+n._src+'" ':"")+(n.width?'width="'+n.width+'" ':"")+(n.height?' height="'+n.height+'" ':"")+("left"==n.floatStyle||"right"==n.floatStyle?' style="float:'+n.floatStyle+';"':"")+(n.title&&""!=n.title?' title="'+n.title+'"':"")+(n.border&&"0"!=n.border?' border="'+n.border+'"':"")+(n.alt&&""!=n.alt?' alt="'+n.alt+'"':"")+(n.hspace&&"0"!=n.hspace?' hspace = "'+n.hspace+'"':"")+(n.vspace&&"0"!=n.vspace?' vspace = "'+n.vspace+'"':"")+"/>","center"==n.floatStyle&&(r='<p style="text-align: center">'+r+"</p>"),o.push(r);else for(var a=0;n=t[a++];)r="<p "+("center"==n.floatStyle?'style="text-align: center" ':"")+'><img src="'+n.src+'" '+(n.width?'width="'+n.width+'" ':"")+(n._src?' _src="'+n._src+'" ':"")+(n.height?' height="'+n.height+'" ':"")+' style="'+(n.floatStyle&&"center"!=n.floatStyle?"float:"+n.floatStyle+";":"")+(n.border||"")+'" '+(n.title?' title="'+n.title+'"':"")+" /></p>",o.push(r);i.execCommand("insertHtml",o.join(""),!0)}}},UM.plugins.justify=function(){var t=this;e.each("justifyleft justifyright justifycenter justifyfull".split(" "),function(e,n){t.commands[n]={execCommand:function(e){return this.document.execCommand(e)},queryCommandValue:function(e){var t=this.document.queryCommandValue(e);return!0===t||"true"===t?e.replace(/justify/,""):""},queryCommandState:function(e){return this.document.queryCommandState(e)?1:0}}})},UM.plugins.font=function(){var t=this,n={forecolor:"forecolor",backcolor:"backcolor",fontsize:"fontsize",fontfamily:"fontname"},i={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"},o={forecolor:"color",fontsize:"size",fontfamily:"face"};t.setOpt({fontfamily:[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"},{name:"sans-serif",val:"sans-serif"}],fontsize:[10,12,16,18,24,32,48]}),t.addOutputRule(function(t){d.each(t.getNodesByTagName("font"),function(t){if("font"==t.tagName){var n=[];for(var i in t.attrs)switch(i){case"size":var o=t.attrs[i];e.each({10:"1",12:"2",16:"3",18:"4",24:"5",32:"6",48:"7"},function(e,t){if(t==o)return o=e,!1}),n.push("font-size:"+o+"px");break;case"color":n.push("color:"+t.attrs[i]);break;case"face":n.push("font-family:"+t.attrs[i]);break;case"style":n.push(t.attrs[i])}t.attrs={style:n.join(";")}}t.tagName="span","span"==t.parentNode.tagName&&1==t.parentNode.children.length&&(e.each(t.attrs,function(e,n){t.parentNode.attrs[e]="style"==e?t.parentNode.attrs[e]+n:n}),t.parentNode.removeChild(t,!0))})});for(var r in n)!function(r){t.commands[r]={execCommand:function(t,o){if("transparent"!=o){var r=this.selection.getRange();if(!r.collapsed){if("fontsize"==t&&(o={10:"1",12:"2",16:"3",18:"4",24:"5",32:"6",48:"7"}[(o+"").replace(/px/,"")]),this.document.execCommand(n[t],!1,o),a.gecko&&e.each(this.$body.find("a"),function(t,n){var i=n.parentNode;if(i.lastChild===i.firstChild&&/FONT|SPAN/.test(i.tagName)){var o=i.cloneNode(!1);o.innerHTML=n.innerHTML,e(n).html("").append(o).insertBefore(i),e(i).remove()}}),!a.ie){var s=this.selection.getNative().getRangeAt(0),l=s.commonAncestorContainer,r=this.selection.getRange(),d=r.createBookmark(!0);e(l).find("a").each(function(t,n){var i=n.parentNode;if("FONT"==i.nodeName){var o=i.cloneNode(!1);o.innerHTML=n.innerHTML,e(n).html("").append(o)}}),r.moveToBookmark(d).select()}return!0}var c=e("<span></span>").css(i[t],o)[0];r.insertNode(c).setStart(c,0).setCursor()}},queryCommandValue:function(n){var r=t.selection.getStart(),a=e(r).css(i[n]);return void 0===a&&(a=e(r).attr(o[n])),a?d.fixColor(n,a).replace(/px/,""):""},queryCommandState:function(e){return this.queryCommandValue(e)}}}(r)},UM.plugins.link=function(){var t=this;t.setOpt("autourldetectinie",!1),a.ie&&!1===this.options.autourldetectinie&&this.addListener("keyup",function(e,t){var n=this,i=t.keyCode;if(13==i||32==i){var o=n.selection.getRange(),r=o.startContainer;if(13==i){if("P"==r.nodeName){var a=r.previousSibling;if(a&&1==a.nodeType){var a=a.lastChild;a&&"A"==a.nodeName&&!a.getAttribute("_href")&&p.remove(a,!0)}}}else 32==i&&3==r.nodeType&&/^\s$/.test(r.nodeValue)&&(r=r.previousSibling)&&"A"==r.nodeName&&!r.getAttribute("_href")&&p.remove(r,!0)}}),this.addOutputRule(function(t){e.each(t.getNodesByTagName("a"),function(e,t){var n=d.html(t.getAttr("_href"));/^(ftp|https?|\/|file)/.test(n)||(n="http://"+n),t.setAttr("href",n),t.setAttr("_href"),""==t.getAttr("title")&&t.setAttr("title")})}),this.addInputRule(function(t){e.each(t.getNodesByTagName("a"),function(e,t){t.setAttr("_href",d.html(t.getAttr("href")))})}),t.commands.link={execCommand:function(t,n){var i=this,o=i.selection.getRange();if(o.collapsed){var r=o.startContainer;(r=p.findParentByTagName(r,"a",!0))?(e(r).attr(n),o.selectNode(r).select()):o.insertNode(e("<a>"+n.href+"</a>").attr(n)[0]).select()}else i.document.execCommand("createlink",!1,"_umeditor_link"),d.each(p.getElementsByTagName(i.body,"a",function(e){return"_umeditor_link"==e.getAttribute("href")}),function(t){"_umeditor_link"==e(t).text()&&e(t).text(n.href),p.setAttributes(t,n),o.selectNode(t).select()})},queryCommandState:function(){return this.queryCommandValue("link")?1:0},queryCommandValue:function(){var t,n=this.selection.getStartElementPath();return e.each(n,function(e,n){if("A"==n.nodeName)return t=n,!1}),t}},t.commands.unlink={execCommand:function(){this.document.execCommand("unlink")}}},UM.commands.print={execCommand:function(){var t=this,n="editor_print_"+ +new Date;e('<iframe src="" id="'+n+'" name="'+n+'" frameborder="0"></iframe>').attr("id",n).css({width:"0px",height:"0px",overflow:"hidden",float:"left",position:"absolute",top:"-10000px",left:"-10000px"}).appendTo(t.$container.find(".edui-dialog-container"));var i=window.open("",n,""),o=i.document;o.open(),o.write("<html><head></head><body><div>"+this.getContent(null,null,!0)+"</div><script>setTimeout(function(){window.print();setTimeout(function(){window.parent.$('#"+n+"').remove();},100);},200);<\/script></body></html>"),o.close()},notNeedUndo:1},UM.plugins.paragraph=function(){var e=this;e.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""}),e.commands.paragraph={execCommand:function(e,t){return this.document.execCommand("formatBlock",!1,"<"+t+">")},queryCommandValue:function(){try{var e=this.document.queryCommandValue("formatBlock")}catch(e){}return e}}},UM.plugins.horizontal=function(){var t=this;t.commands.horizontal={execCommand:function(){this.document.execCommand("insertHorizontalRule");var n=t.selection.getRange().txtToElmBoundary(!0),i=n.startContainer;if(p.isBody(n.startContainer)){var o=n.startContainer.childNodes[n.startOffset];o||(o=e("<p></p>").appendTo(n.startContainer).html(a.ie?"&nbsp;":"<br/>")[0]),n.setStart(o,0).setCursor()}else{for(;u.$inline[i.tagName]&&i.lastChild===i.firstChild;){var r=i.parentNode;r.appendChild(i.firstChild),r.removeChild(i),i=r}for(;u.$inline[i.tagName];)i=i.parentNode;if(1==i.childNodes.length&&"HR"==i.lastChild.nodeName){var s=i.lastChild;e(s).insertBefore(i),n.setStart(i,0).setCursor()}else{s=e("hr",i)[0],p.breakParent(s,i);var l=s.previousSibling;l&&p.isEmptyBlock(l)&&e(l).remove(),n.setStart(s.nextSibling,0).setCursor()}}}}},UM.commands.cleardoc={execCommand:function(){var e=this,t=e.selection.getRange();e.body.innerHTML="<p>"+(l?"":"<br/>")+"</p>",t.setStart(e.body.firstChild,0).setCursor(!1,!0),setTimeout(function(){e.fireEvent("clearDoc")},0)}},UM.plugins.undo=function(){function t(e,t){if(e.length!=t.length)return 0;for(var n=0,i=e.length;n<i;n++)if(e[n]!=t[n])return 0;return 1}function n(e,n){return e.collapsed!=n.collapsed?0:t(e.startAddress,n.startAddress)&&t(e.endAddress,n.endAddress)?1:0}function i(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&1==this.list.length)return void this.reset();for(;this.list[this.index].content==this.list[this.index-1].content;)if(0==--this.index)return this.restore(0);this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){for(;this.list[this.index].content==this.list[this.index+1].content;)if(++this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}},this.restore=function(){var e=this.editor,t=this.list[this.index],n=UM.htmlparser(t.content.replace(h,""));e.options.autoClearEmptyNode=!1,e.filterInputRule(n,!0),e.options.autoClearEmptyNode=g,e.body.innerHTML=n.toHtml(),e.fireEvent("afterscencerestore"),a.ie&&d.each(p.getElementsByTagName(e.document,"td th caption p"),function(t){p.isEmptyNode(t)&&p.fillNode(e.document,t)});try{var i=new o.Range(e.document,e.body).moveToAddress(t.address);if(a.ie&&i.collapsed&&1==i.startContainer.nodeType){var r=i.startContainer.childNodes[i.startOffset];(!r||1==r.nodeType&&u.$empty[r])&&i.insertNode(e.document.createTextNode(" ")).collapse(!0)}i.select(m[i.startContainer.nodeName.toLowerCase()])}catch(e){}this.update(),this.clearKey(),e.fireEvent("reset",!0)},this.getScene=function(){var e=this.editor,t=e.selection.getRange(),n=t.createAddress(!1,!0);e.fireEvent("beforegetscene");var i=UM.htmlparser(e.body.innerHTML,!0);e.options.autoClearEmptyNode=!1,e.filterOutputRule(i,!0),e.options.autoClearEmptyNode=g;var o=i.toHtml();return a.ie&&(o=o.replace(/>&nbsp;</g,"><").replace(/\s*</g,"<").replace(/>\s*/g,">")),e.fireEvent("aftergetscene"),{address:n,content:o}},this.save=function(e,t){clearTimeout(s);var i=this.getScene(t),o=this.list[this.index];o&&o.content==i.content&&(e?1:n(o.address,i.address))||(this.list=this.list.slice(0,this.index+1),this.list.push(i),this.list.length>c&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update())},this.update=function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1]},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){y=0,v=null}}function r(){this.undoManger.save()}var s,l=this,c=l.options.maxUndoCount||20,f=l.options.maxInputCount||20,h=new RegExp(p.fillChar+"|</hr>","gi"),m={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},g=l.options.autoClearEmptyNode;l.undoManger=new i,l.undoManger.editor=l,l.addListener("saveScene",function(){var e=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,e)}),l.addListener("beforeexeccommand",r),l.addListener("afterexeccommand",r),l.addListener("reset",function(e,t){t||this.undoManger.reset()}),l.commands.redo=l.commands.undo={execCommand:function(e){this.undoManger[e]()},queryCommandState:function(e){return this.undoManger["has"+("undo"==e.toLowerCase()?"Undo":"Redo")]?0:-1},notNeedUndo:1};var v,b={16:1,17:1,18:1,37:1,38:1,39:1,40:1},y=0,C=!1;l.addListener("ready",function(){e(this.body).on("compositionstart",function(){C=!0}).on("compositionend",function(){C=!1})}),l.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89,shift+ctrl+z"});var x=!0;l.addListener("keydown",function(e,t){var n=this,i=t.keyCode||t.which;if(!(b[i]||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)){var o=function(e){e.selection.getRange().collapsed&&e.fireEvent("contentchange"),e.undoManger.save(!1,!0),e.fireEvent("selectionchange")};if(C)return;if(!n.selection.getRange().collapsed)return n.undoManger.save(!1,!0),void(x=!1);0==n.undoManger.list.length&&n.undoManger.save(!0),clearTimeout(s),s=setTimeout(function(){if(C)var e=setInterval(function(){C||(o(n),clearInterval(e))},300);else o(n)},200),v=i,y++,y>=f&&o(n)}}),l.addListener("keyup",function(e,t){var n=t.keyCode||t.which;if(!(b[n]||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)){if(C)return;x||(this.undoManger.save(!1,!0),x=!0)}})},UM.plugins.paste=function(){function t(t){var n=this.document;if(!n.getElementById("baidu_pastebin")){var i=this.selection.getRange(),o=i.createBookmark(),r=n.createElement("div");r.id="baidu_pastebin",a.webkit&&r.appendChild(n.createTextNode(p.fillChar+p.fillChar)),this.body.appendChild(r),o.start.style.display="",r.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+e(o.start).position().top+"px",i.selectNodeContents(r).select(!0),setTimeout(function(){if(a.webkit)for(var e,s=0,l=n.querySelectorAll("#baidu_pastebin");e=l[s++];){if(!p.isEmptyNode(e)){r=e;break}p.remove(e)}try{r.parentNode.removeChild(r)}catch(e){}i.moveToBookmark(o).select(!0),t(r)},0)}}function n(e){var t;if(e.firstChild){for(var n,o=p.getElementsByTagName(e,"span"),r=0;n=o[r++];)"_baidu_cut_start"!=n.id&&"_baidu_cut_end"!=n.id||p.remove(n);if(a.webkit){for(var s,l=e.querySelectorAll("div br"),r=0;s=l[r++];){var c=s.parentNode;"DIV"==c.tagName&&1==c.childNodes.length&&(c.innerHTML="<p><br/></p>",p.remove(c))}for(var u,f=e.querySelectorAll("#baidu_pastebin"),r=0;u=f[r++];){var h=i.document.createElement("p");for(u.parentNode.insertBefore(h,u);u.firstChild;)h.appendChild(u.firstChild);p.remove(u)}for(var m,g=e.querySelectorAll("meta"),r=0;m=g[r++];)p.remove(m);var l=e.querySelectorAll("br");for(r=0;m=l[r++];)/^apple-/i.test(m.className)&&p.remove(m)}if(a.gecko){var v=e.querySelectorAll("[_moz_dirty]");for(r=0;m=v[r++];)m.removeAttribute("_moz_dirty")}if(!a.ie)for(var m,b=e.querySelectorAll("span.Apple-style-span"),r=0;m=b[r++];)p.remove(m,!0);t=e.innerHTML,t=UM.filterWord(t);var y=UM.htmlparser(t);if(i.options.filterRules&&UM.filterNode(y,i.options.filterRules),i.filterInputRule(y),a.webkit){var C=y.lastChild();C&&"element"==C.type&&"br"==C.tagName&&y.removeChild(C),d.each(i.body.querySelectorAll("div"),function(e){p.isEmptyBlock(e)&&p.remove(e)})}if(t={html:y.toHtml()},i.fireEvent("beforepaste",t,y),!t.html)return;i.execCommand("insertHtml",t.html,!0),i.fireEvent("afterpaste",t)}}var i=this;i.addListener("ready",function(){e(i.body).on("cut",function(){!i.selection.getRange().collapsed&&i.undoManger&&i.undoManger.save()}).on(a.ie||a.opera?"keydown":"paste",function(e){(!a.ie&&!a.opera||(e.ctrlKey||e.metaKey)&&"86"==e.keyCode)&&t.call(i,function(e){n(e)})})})},UM.plugins.enterkey=function(){var t,n=this,i=n.options.enterTag;n.addListener("keyup",function(e,i){if(13==(i.keyCode||i.which)){var o,r=n.selection.getRange(),s=r.startContainer;if(a.ie)n.fireEvent("saveScene",!0,!0);else{if(/h\d/i.test(t)){if(a.gecko)p.findParentByTagName(s,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0)||(n.document.execCommand("formatBlock",!1,"<p>"),o=1);else if(1==s.nodeType){var l,d=n.document.createTextNode("");if(r.insertNode(d),l=p.findParentByTagName(d,"div",!0)){for(var c=n.document.createElement("p");l.firstChild;)c.appendChild(l.firstChild);l.parentNode.insertBefore(c,l),p.remove(l),r.setStartBefore(d).setCursor(),o=1}p.remove(d)}n.undoManger&&o&&n.undoManger.save()}a.opera&&r.select()}}}),n.addListener("keydown",function(e,o){if(13==(o.keyCode||o.which)){if(n.fireEvent("beforeenterkeydown"))return void p.preventDefault(o);n.fireEvent("saveScene",!0,!0),t="";var r=n.selection.getRange();if(!r.collapsed){var s=r.startContainer,l=r.endContainer,d=p.findParentByTagName(s,"td",!0),c=p.findParentByTagName(l,"td",!0);if(d&&c&&d!==c||!d&&c||d&&!c)return void(o.preventDefault?o.preventDefault():o.returnValue=!1)}"p"==i&&(a.ie||(s=p.findParentByTagName(r.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0),s||a.opera?(t=s.tagName,"p"==s.tagName.toLowerCase()&&a.gecko&&p.removeDirtyAttr(s)):(n.document.execCommand("formatBlock",!1,"<p>"),a.gecko&&(r=n.selection.getRange(),(s=p.findParentByTagName(r.startContainer,"p",!0))&&p.removeDirtyAttr(s)))))}}),a.ie&&n.addListener("setDisabled",function(){e(n.body).find("p").each(function(e,t){p.isEmptyBlock(t)&&(t.innerHTML="&nbsp;")})})},UM.plugins.basestyle=function(){var t=["bold","underline","superscript","subscript","italic","strikethrough"],n=this;n.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+shift+85",strikeThrough:"ctrl+shift+83"}),n.addOutputRule(function(t){e.each(t.getNodesByTagName("b i u strike s"),function(e,t){switch(t.tagName){case"b":t.tagName="strong";break;case"i":t.tagName="em";break;case"u":t.tagName="span",t.setStyle("text-decoration","underline");break;case"s":case"strike":t.tagName="span",t.setStyle("text-decoration","line-through")}})}),e.each(t,function(t,i){n.commands[i]={execCommand:function(e){var t=this.selection.getRange();if(t.collapsed&&1!=this.queryCommandState(e)){var n=this.document.createElement({bold:"strong",underline:"u",superscript:"sup",subscript:"sub",italic:"em",strikethrough:"strike"}[e]);return t.insertNode(n).setStart(n,0).setCursor(!1),!0}return this.document.execCommand(e)},queryCommandState:function(t){if(a.gecko)return this.document.queryCommandState(t);var n=this.selection.getStartElementPath(),i=!1;return e.each(n,function(n,o){switch(t){case"bold":if("STRONG"==o.nodeName||"B"==o.nodeName)return i=1,!1;break;case"underline":if("U"==o.nodeName||"SPAN"==o.nodeName&&"underline"==e(o).css("text-decoration"))return i=1,!1;break;case"superscript":if("SUP"==o.nodeName)return i=1,!1;break;case"subscript":if("SUB"==o.nodeName)return i=1,!1;break;case"italic":if("EM"==o.nodeName||"I"==o.nodeName)return i=1,!1;break;case"strikethrough":if("S"==o.nodeName||"STRIKE"==o.nodeName||"SPAN"==o.nodeName&&"line-through"==e(o).css("text-decoration"))return i=1,!1}}),i}}})},UM.plugins.selectall=function(){var e=this;e.commands.selectall={execCommand:function(){var e=this,t=e.body,n=e.selection.getRange();n.selectNodeContents(t),p.isEmptyBlock(t)&&(a.opera&&t.firstChild&&1==t.firstChild.nodeType&&n.setStartAtFirst(t.firstChild),n.collapse(!0)),n.select(!0)},notNeedUndo:1},e.addshortcutkey({selectAll:"ctrl+65"})},UM.plugins.removeformat=function(){var e=this;e.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"}),e.commands.removeformat={execCommand:function(e,t,n,i,r){function s(e){if(3==e.nodeType||"span"!=e.tagName.toLowerCase())return 0;if(a.ie){var t=e.attributes;if(t.length){for(var n=0,i=t.length;n<i;n++)if(t[n].specified)return 0;return 1}}return!e.attributes.length}var l,d,c=new RegExp("^(?:"+(t||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),f=n?[]:(i||this.options.removeFormatAttributes).split(","),h=new o.Range(this.document),m=function(e){return 1==e.nodeType};h=this.selection.getRange(),h.collapsed||(!function(e){var t=e.createBookmark();if(e.collapsed&&e.enlarge(!0),!r){var i=p.findParentByTagName(e.startContainer,"a",!0);i&&e.setStartBefore(i),(i=p.findParentByTagName(e.endContainer,"a",!0))&&e.setEndAfter(i)}for(l=e.createBookmark(),v=l.start;(d=v.parentNode)&&!p.isBlockElm(d);)p.breakParent(v,d),p.clearEmptySibling(v);if(l.end){for(v=l.end;(d=v.parentNode)&&!p.isBlockElm(d);)p.breakParent(v,d),p.clearEmptySibling(v);for(var o,a=p.getNextDomNode(l.start,!1,m);a&&a!=l.end;)o=p.getNextDomNode(a,!0,m),u.$empty[a.tagName.toLowerCase()]||p.isBookmarkNode(a)||(c.test(a.tagName)?n?(p.removeStyle(a,n),s(a)&&"text-decoration"!=n&&p.remove(a,!0)):p.remove(a,!0):u.$tableContent[a.tagName]||u.$list[a.tagName]||(p.removeAttributes(a,f),s(a)&&p.remove(a,!0))),a=o}var h=l.start.parentNode;!p.isBlockElm(h)||u.$tableContent[h.tagName]||u.$list[h.tagName]||p.removeAttributes(h,f),h=l.end.parentNode,l.end&&p.isBlockElm(h)&&!u.$tableContent[h.tagName]&&!u.$list[h.tagName]&&p.removeAttributes(h,f),e.moveToBookmark(l).moveToBookmark(t);for(var g,v=e.startContainer,b=e.collapsed;1==v.nodeType&&p.isEmptyNode(v)&&u.$removeEmpty[v.tagName];)g=v.parentNode,e.setStartBefore(v),e.startContainer===e.endContainer&&e.endOffset--,p.remove(v),v=g;if(!b)for(v=e.endContainer;1==v.nodeType&&p.isEmptyNode(v)&&u.$removeEmpty[v.tagName];)g=v.parentNode,e.setEndBefore(v),p.remove(v),v=g}(h),h.select())}}},UM.plugins.keystrokes=function(){var t=this,n=!0;t.addListener("keydown",function(i,o){var r=o.keyCode||o.which,s=t.selection.getRange();if(!s.collapsed&&!(o.ctrlKey||o.shiftKey||o.altKey||o.metaKey)&&(r>=65&&r<=90||r>=48&&r<=57||r>=96&&r<=111||{13:1,8:1,46:1}[r])){var l=s.startContainer;if(p.isFillChar(l)&&s.setStartBefore(l),l=s.endContainer,p.isFillChar(l)&&s.setEndAfter(l),s.txtToElmBoundary(),s.endContainer&&1==s.endContainer.nodeType&&(l=s.endContainer.childNodes[s.endOffset])&&p.isBr(l)&&s.setEndAfter(l),0==s.startOffset&&(l=s.startContainer,p.isBoundaryNode(l,"firstChild")&&(l=s.endContainer,s.endOffset==(3==l.nodeType?l.nodeValue.length:l.childNodes.length)&&p.isBoundaryNode(l,"lastChild"))))return t.fireEvent("saveScene"),t.body.innerHTML="<p>"+(a.ie?"":"<br/>")+"</p>",s.setStart(t.body.firstChild,0).setCursor(!1,!0),void t._selectionChange()}if(8==r){if(s=t.selection.getRange(),n=s.collapsed,t.fireEvent("delkeydown",o))return;var d,c;if(s.collapsed&&s.inFillChar()&&(d=s.startContainer,p.isFillChar(d)?(s.setStartBefore(d).shrinkBoundary(!0).collapse(!0),p.remove(d)):(d.nodeValue=d.nodeValue.replace(new RegExp("^"+p.fillChar),""),s.startOffset--,s.collapse(!0).select(!0))),d=s.getClosedNode())return t.fireEvent("saveScene"),s.setStartBefore(d),p.remove(d),s.setCursor(),t.fireEvent("saveScene"),void p.preventDefault(o);if(!a.ie&&(d=p.findParentByTagName(s.startContainer,"table",!0),c=p.findParentByTagName(s.endContainer,"table",!0),d&&!c||!d&&c||d!==c))return void o.preventDefault();if(d=s.startContainer,s.collapsed&&1==d.nodeType){var u=d.childNodes[s.startOffset-1];u&&1==u.nodeType&&"BR"==u.tagName&&(t.fireEvent("saveScene"),s.setStartBefore(u).collapse(!0),p.remove(u),s.select(),t.fireEvent("saveScene"))}if(a.chrome&&s.collapsed){for(;0==s.startOffset&&!p.isEmptyBlock(s.startContainer);)s.setStartBefore(s.startContainer);var f=s.startContainer.childNodes[s.startOffset-1];f&&"BR"==f.nodeName&&(s.setStartBefore(f),t.fireEvent("saveScene"),e(f).remove(),s.setCursor(),t.fireEvent("saveScene"))}}if(a.gecko&&46==r){var h=t.selection.getRange();if(h.collapsed&&(d=h.startContainer,p.isEmptyBlock(d))){for(var m=d.parentNode;1==p.getChildCount(m)&&!p.isBody(m);)d=m,m=m.parentNode;return void(d===m.lastChild&&o.preventDefault())}}}),t.addListener("keyup",function(e,t){var i,o=t.keyCode||t.which,r=this;if(8==o){if(r.fireEvent("delkeyup"))return;if(i=r.selection.getRange(),i.collapsed){var s,l=["h1","h2","h3","h4","h5","h6"];if((s=p.findParentByTagName(i.startContainer,l,!0))&&p.isEmptyBlock(s)){var d=s.previousSibling;if(d&&"TABLE"!=d.nodeName)return p.remove(s),void i.setStartAtLast(d).setCursor(!1,!0);var c=s.nextSibling;if(c&&"TABLE"!=c.nodeName)return p.remove(s),void i.setStartAtFirst(c).setCursor(!1,!0)}if(p.isBody(i.startContainer)){var s=p.createElement(r.document,"p",{innerHTML:a.ie?p.fillChar:"<br/>"});i.insertNode(s).setStart(s,0).setCursor(!1,!0)}}if(!n&&(3==i.startContainer.nodeType||1==i.startContainer.nodeType&&p.isEmptyBlock(i.startContainer)))if(a.ie){var u=i.document.createElement("span");i.insertNode(u).setStartBefore(u).collapse(!0),i.select(),p.remove(u)}else i.select()}})},function(e){function t(t,n,i){if(t.prototype=e.extend2(e.extend({},n),(UM.ui[i]||o).prototype,!0),t.prototype.supper=(UM.ui[i]||o).prototype,UM.ui[i]&&UM.ui[i].prototype.defaultOpt){var r=UM.ui[i].prototype.defaultOpt,a=t.prototype.defaultOpt;t.prototype.defaultOpt=e.extend({},r,a||{})}return t}function n(t,n){e[r+n]=t,e.fn[r+n]=function(n){var i,o=Array.prototype.slice.call(arguments,1);return this.each(function(r,a){var s=e(a),l=s.edui();if(l||(t(n&&e.isPlainObject(n)?n:{},s),s.edui(l)),"string"==e.type(n))if("this"==n)i=l;else{if((i=l[n].apply(l,o))!==l&&void 0!==i)return!1;i=null}}),null!==i?i:this}}e.parseTmpl=function(e,t){var n="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/<%=([\s\S]+?)%>/g,function(e,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(/<%([\s\S]+?)%>/g,function(e,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",i=new Function("obj",n);return t?i(t):i},e.extend2=function(t,n){for(var i=arguments,o="boolean"==e.type(i[i.length-1])&&i[i.length-1],r="boolean"==e.type(i[i.length-1])?i.length-1:i.length,a=1;a<r;a++){var s=i[a];for(var l in s)o&&t.hasOwnProperty(l)||(t[l]=s[l])}return t},e.IE6=!!window.ActiveXObject&&6==parseFloat(navigator.userAgent.match(/msie (\d+)/i)[1]);var i=[],o=function(){},r="edui";o.prototype={on:function(t,n){return this.root().on(t,e.proxy(n,this)),this},off:function(t,n){return this.root().off(t,e.proxy(n,this)),this},trigger:function(e,t){return!1!==this.root().trigger(e,t)&&this},root:function(e){return this._$el||(this._$el=e)},destroy:function(){},data:function(e,t){return void 0!==t?(this.root().data(r+e,t),this):this.root().data(r+e)},register:function(t,n,o){i.push({evtname:t,$els:e.isArray(n)?n:[n],handler:e.proxy(o,n)})}},e.fn.edui=function(e){return e?this.data("eduiwidget",e):this.data("eduiwidget")};var a=1;UM.ui={define:function(i,o,s){var l=UM.ui[i]=t(function(t,n){var o=function(){};e.extend(o.prototype,l.prototype,{guid:i+a++,widgetName:i});var s=new o;if("string"==e.type(t))return s.init&&s.init({}),s.root().edui(s),s.root().find("a").click(function(e){e.preventDefault()}),s.root()[r+i].apply(s.root(),arguments);n&&s.root(n),s.init&&s.init(!t||e.isPlainObject(t)?e.extend2(t||{},s.defaultOpt||{},!0):t);try{s.root().find("a").click(function(e){e.preventDefault()})}catch(e){}return s.root().edui(s)},o,s);n(l,i)}},e(function(){e(document).on("click mouseup mousedown dblclick mouseover",function(t){e.each(i,function(n,i){i.evtname==t.type&&e.each(i.$els,function(n,o){o[0]===t.target||e.contains(o[0],t.target)||i.handler(t)})})})})}(jQuery),UM.ui.define("button",{tpl:'<<%if(!texttype){%>div class="edui-btn edui-btn-<%=icon%> <%if(name){%>edui-btn-name-<%=name%><%}%>" unselectable="on" onmousedown="return false" <%}else{%>a class="edui-text-btn"<%}%><% if(title) {%> data-original-title="<%=title%>" <%};%>> <% if(icon) {%><div unselectable="on" class="edui-icon-<%=icon%> edui-icon"></div><% }; %><%if(text) {%><span unselectable="on" onmousedown="return false" class="edui-button-label"><%=text%></span><%}%><%if(caret && text){%><span class="edui-button-spacing"></span><%}%><% if(caret) {%><span unselectable="on" onmousedown="return false" class="edui-caret"></span><% };%></<%if(!texttype){%>div<%}else{%>a<%}%>>',defaultOpt:{text:"",title:"",icon:"",width:"",caret:!1,texttype:!1,click:function(){}},init:function(t){var n=this;return n.root(e(e.parseTmpl(n.tpl,t))).click(function(e){n.wrapclick(t.click,e)}),n.root().hover(function(){n.root().hasClass("edui-disabled")||n.root().toggleClass("edui-hover")}),n},wrapclick:function(t,n){return this.disabled()||(this.root().trigger("wrapclick"),e.proxy(t,this,n)()),this},label:function(e){return void 0===e?this.root().find(".edui-button-label").text():(this.root().find(".edui-button-label").text(e),this)},disabled:function(e){return void 0===e?this.root().hasClass("edui-disabled"):(this.root().toggleClass("edui-disabled",e),this.root().hasClass("edui-disabled")&&this.root().removeClass("edui-hover"),this)},active:function(e){return void 0===e?this.root().hasClass("edui-active"):(this.root().toggleClass("edui-active",e),this)},mergeWith:function(t){var n=this;n.data("$mergeObj",t),t.edui().data("$mergeObj",n.root()),e.contains(document.body,t[0])||t.appendTo(n.root()),n.on("click",function(){n.wrapclick(function(){t.edui().show()})}).register("click",n.root(),function(e){t.hide()})}}),function(){UM.ui.define("toolbar",{tpl:'<div class="edui-toolbar"  ><div class="edui-btn-toolbar" unselectable="on" onmousedown="return false"  ></div></div>',init:function(){var t=this.root(e(this.tpl));this.data("$btnToolbar",t.find(".edui-btn-toolbar"))},appendToBtnmenu:function(t){var n=this.data("$btnToolbar");t=e.isArray(t)?t:[t],e.each(t,function(e,t){n.append(t)})}})}(),UM.ui.define("menu",{show:function(t,n,i,o,r){i=i||"position",!1!==this.trigger("beforeshow")&&(this.root().css(e.extend({display:"block"},t?{top:t[i]().top+("right"==n?0:t.outerHeight())-(o||0),left:t[i]().left+("right"==n?t.outerWidth():0)-(r||0)}:{})),this.trigger("aftershow"))},hide:function(e){var t;!1!==this.trigger("beforehide")&&((t=this.root().data("parentmenu"))&&(t.data("parentmenu")||e)&&t.edui().hide(),this.root().css("display","none"),this.trigger("afterhide"))},attachTo:function(e){var t=this;e.data("$mergeObj")||(e.data("$mergeObj",t.root()),e.on("wrapclick",function(e){t.show()}),t.register("click",e,function(e){t.hide()}),t.data("$mergeObj",e))}}),UM.ui.define("scale",{tpl:'<div class="edui-scale" unselectable="on"><span class="edui-scale-hand0"></span><span class="edui-scale-hand1"></span><span class="edui-scale-hand2"></span><span class="edui-scale-hand3"></span><span class="edui-scale-hand4"></span><span class="edui-scale-hand5"></span><span class="edui-scale-hand6"></span><span class="edui-scale-hand7"></span></div>',defaultOpt:{$doc:e(document),$wrap:e(document)},init:function(t){return t.$doc&&(this.defaultOpt.$doc=t.$doc),t.$wrap&&(this.defaultOpt.$wrap=t.$wrap),this.root(e(e.parseTmpl(this.tpl,t))),this.initStyle(),this.startPos=this.prePos={x:0,y:0},this.dragId=-1,this},initStyle:function(){d.cssRule("edui-style-scale",".edui-scale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;}.edui-scale span{position:absolute;left:0;top:0;width:7px;height:7px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}.edui-scale .edui-scale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}.edui-scale .edui-scale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}.edui-scale .edui-scale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}.edui-scale .edui-scale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}.edui-scale .edui-scale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}.edui-scale .edui-scale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}.edui-scale .edui-scale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}.edui-scale .edui-scale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")},_eventHandler:function(t){var n=this,i=n.defaultOpt.$doc;switch(t.type){case"mousedown":var o,o=t.target||t.srcElement;-1!=o.className.indexOf("edui-scale-hand")&&(n.dragId=o.className.slice(-1),n.startPos.x=n.prePos.x=t.clientX,n.startPos.y=n.prePos.y=t.clientY,i.bind("mousemove",e.proxy(n._eventHandler,n)));break;case"mousemove":-1!=n.dragId&&(n.updateContainerStyle(n.dragId,{x:t.clientX-n.prePos.x,y:t.clientY-n.prePos.y}),n.prePos.x=t.clientX,n.prePos.y=t.clientY,n.updateTargetElement());break;case"mouseup":if(-1!=n.dragId){n.dragId=-1,n.updateTargetElement();n.data("$scaleTarget").parent()&&n.attachTo(n.data("$scaleTarget"))}i.unbind("mousemove",e.proxy(n._eventHandler,n))}},updateTargetElement:function(){var e=this,t=e.root(),n=e.data("$scaleTarget");n.css({width:t.width(),height:t.height()}),e.attachTo(n)},updateContainerStyle:function(e,t){var n,i=this,o=i.root(),r=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]];0!=r[e][0]&&(n=parseInt(o.offset().left)+t.x,o.css("left",i._validScaledProp("left",n))),0!=r[e][1]&&(n=parseInt(o.offset().top)+t.y,o.css("top",i._validScaledProp("top",n))),0!=r[e][2]&&(n=o.width()+r[e][2]*t.x,o.css("width",i._validScaledProp("width",n))),0!=r[e][3]&&(n=o.height()+r[e][3]*t.y,o.css("height",i._validScaledProp("height",n)))},_validScaledProp:function(e,t){var n=this.root(),i=this.defaultOpt.$doc,o=function(e,n,i){return e+n>i?i-n:t};switch(t=isNaN(t)?0:t,e){case"left":return t<0?0:o(t,n.width(),i.width());case"top":return t<0?0:o(t,n.height(),i.height());case"width":return t<=0?1:o(t,n.offset().left,i.width());case"height":return t<=0?1:o(t,n.offset().top,i.height())}},show:function(t){var n=this;t&&n.attachTo(t),n.root().bind("mousedown",e.proxy(n._eventHandler,n)),n.defaultOpt.$doc.bind("mouseup",e.proxy(n._eventHandler,n)),n.root().show(),n.trigger("aftershow")},hide:function(){var t=this;t.root().unbind("mousedown",e.proxy(t._eventHandler,t)),t.defaultOpt.$doc.unbind("mouseup",e.proxy(t._eventHandler,t)),t.root().hide(),t.trigger("afterhide")},attachTo:function(e){var t=this,n=e.offset(),i=t.root(),o=t.defaultOpt.$wrap,r=o.offset();t.data("$scaleTarget",e),t.root().css({position:"absolute",width:e.width(),height:e.height(),left:n.left-r.left-parseInt(o.css("border-left-width"))-parseInt(i.css("border-left-width")),top:n.top-r.top-parseInt(o.css("border-top-width"))-parseInt(i.css("border-top-width"))})},getScaleTarget:function(){return this.data("$scaleTarget")[0]}}),function(){UM.ui.define("combobox",function(){return{tpl:'<ul class="dropdown-menu edui-combobox-menu<%if (comboboxName!==\'\') {%> edui-combobox-<%=comboboxName%><%}%>" unselectable="on" onmousedown="return false" role="menu" aria-labelledby="dropdownMenu"><%if(autoRecord) {%><%for( var i=0, len = recordStack.length; i<len; i++ ) {%><%var index = recordStack[i];%><li class="<%=itemClassName%><%if( selected == index ) {%> edui-combobox-checked<%}%>" data-item-index="<%=index%>" unselectable="on" onmousedown="return false"><span class="edui-combobox-icon" unselectable="on" onmousedown="return false"></span><label class="<%=labelClassName%>" style="<%=itemStyles[ index ]%>" unselectable="on" onmousedown="return false"><%=items[index]%></label></li><%}%><%if( i ) {%><li class="edui-combobox-item-separator"></li><%}%><%}%><%for( var i=0, label; label = items[i]; i++ ) {%><li class="<%=itemClassName%><%if( selected == i ) {%> edui-combobox-checked<%}%> edui-combobox-item-<%=i%>" data-item-index="<%=i%>" unselectable="on" onmousedown="return false"><span class="edui-combobox-icon" unselectable="on" onmousedown="return false"></span><label class="<%=labelClassName%>" style="<%=itemStyles[ i ]%>" unselectable="on" onmousedown="return false"><%=label%></label></li><%}%></ul>',defaultOpt:{recordStack:[],items:[],value:[],comboboxName:"",selected:"",autoRecord:!0,recordCount:5},init:function(t){var n=this;e.extend(n._optionAdaptation(t),n._createItemMapping(t.recordStack,t.items),{itemClassName:"edui-combobox-item",iconClass:"edui-combobox-checked-icon",labelClassName:"edui-combobox-item-label"}),this._transStack(t),n.root(e(e.parseTmpl(n.tpl,t))),this.data("options",t).initEvent()},initEvent:function(){this.initSelectItem(),this.initItemActive()},initSelectItem:function(){var t=this;t.root().delegate(".edui-combobox-item","click",function(){var n=e(this),i=n.attr("data-item-index");return t.trigger("comboboxselect",{index:i,label:n.find(".edui-combobox-item-label").text(),value:t.data("options").value[i]}).select(i),t.hide(),!1})},initItemActive:function(){var t={mouseenter:"addClass",mouseleave:"removeClass"};e.IE6&&this.root().delegate(".edui-combobox-item","mouseenter mouseleave",function(n){e(this)[t[n.type]]("edui-combobox-item-hover")}).one("afterhide",function(){})},select:function(e){var t=this.data("options").itemCount,n=this.data("options").autowidthitem;return n&&!n.length&&(n=this.data("options").items),0==t?null:(e<0?e=t+e%t:e>=t&&(e=t-1),this.trigger("changebefore",n[e]),this._update(e),this.trigger("changeafter",n[e]),null)},selectItemByLabel:function(t){var n=this.data("options").itemMapping,i=this,o=null;!e.isArray(t)&&(t=[t]),e.each(t,function(e,t){if(void 0!==(o=n[t]))return i.select(o),!1})},_transStack:function(t){var n=[],i=-1,o=-1;e.each(t.recordStack,function(r,a){i=t.itemMapping[a],e.isNumeric(i)&&(n.push(i),a==t.selected&&(o=i))}),t.recordStack=n,t.selected=o,n=null},_optionAdaptation:function(e){if(!("itemStyles"in e)){e.itemStyles=[];for(var t=0,n=e.items.length;t<n;t++)e.itemStyles.push("")}return e.autowidthitem=e.autowidthitem||e.items,e.itemCount=e.items.length,e},_createItemMapping:function(t,n){var i={},o={recordStack:[],mapping:{}};return e.each(n,function(e,t){i[t]=e}),o.itemMapping=i,e.each(t,function(e,t){void 0!==i[t]&&(o.recordStack.push(i[t]),o.mapping[t]=i[t])}),o},_update:function(t){var n=this.data("options"),i=[],o=null;e.each(n.recordStack,function(e,n){n!=t&&i.push(n)}),i.unshift(t),i.length>n.recordCount&&(i.length=n.recordCount),n.recordStack=i,n.selected=t,o=e(e.parseTmpl(this.tpl,n)),this.root().html(o.html()),o=null,i=null}}}(),"menu")}(),function(){UM.ui.define("buttoncombobox",function(){return{defaultOpt:{label:"",title:""},init:function(t){var n=this,i=e.eduibutton({caret:!0,name:t.comboboxName,title:t.title,text:t.label,click:function(){n.show(this.root())}});n.supper.init.call(n,t),n.on("changebefore",function(e,t){i.eduibutton("label",t)}),n.data("button",i),n.attachTo(i)},button:function(){return this.data("button")}}}(),"combobox")}(),UM.ui.define("modal",{tpl:'<div class="edui-modal" tabindex="-1" ><div class="edui-modal-header"><div class="edui-close" data-hide="modal"></div><h3 class="edui-title"><%=title%></h3></div><div class="edui-modal-body"  style="<%if(width){%>width:<%=width%>px;<%}%><%if(height){%>height:<%=height%>px;<%}%>"> </div><% if(cancellabel || oklabel) {%><div class="edui-modal-footer"><div class="edui-modal-tip"></div><%if(oklabel){%><div class="edui-btn edui-btn-primary" data-ok="modal"><%=oklabel%></div><%}%><%if(cancellabel){%><div class="edui-btn" data-hide="modal"><%=cancellabel%></div><%}%></div><%}%></div>',defaultOpt:{title:"",cancellabel:"",oklabel:"",width:"",height:"",backdrop:!0,keyboard:!0},init:function(t){var n=this;n.root(e(e.parseTmpl(n.tpl,t||{}))),n.data("options",t),t.okFn&&n.on("ok",e.proxy(t.okFn,n)),t.cancelFn&&n.on("beforehide",e.proxy(t.cancelFn,n)),n.root().delegate('[data-hide="modal"]',"click",e.proxy(n.hide,n)).delegate('[data-ok="modal"]',"click",e.proxy(n.ok,n)),e('[data-hide="modal"],[data-ok="modal"]',n.root()).hover(function(){e(this).toggleClass("edui-hover")})},toggle:function(){var e=this;return e[e.data("isShown")?"hide":"show"]()},show:function(){var e=this;e.trigger("beforeshow"),e.data("isShown")||(e.data("isShown",!0),e.escape(),e.backdrop(function(){e.autoCenter(),e.root().show().focus().trigger("aftershow")}))},showTip:function(t){e(".edui-modal-tip",this.root()).html(t).fadeIn()},hideTip:function(t){e(".edui-modal-tip",this.root()).fadeOut(function(){e(this).html("")})},autoCenter:function(){!e.IE6&&this.root().css("margin-left",-this.root().width()/2)},hide:function(){var e=this;e.trigger("beforehide"),e.data("isShown")&&(e.data("isShown",!1),e.escape(),e.hideModal())},escape:function(){var e=this;e.data("isShown")&&e.data("options").keyboard?e.root().on("keyup",function(t){27==t.which&&e.hide()}):e.data("isShown")||e.root().off("keyup")},hideModal:function(){var e=this;e.root().hide(),e.backdrop(function(){e.removeBackdrop(),e.trigger("afterhide")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this;n.data("isShown")&&n.data("options").backdrop&&(n.$backdrop=e('<div class="edui-modal-backdrop" />').click("static"==n.data("options").backdrop?e.proxy(n.root()[0].focus,n.root()[0]):e.proxy(n.hide,n))),n.trigger("afterbackdrop"),t&&t()},attachTo:function(e){var t=this;e.data("$mergeObj")||(e.data("$mergeObj",t.root()),e.on("click",function(){t.toggle(e)}),t.data("$mergeObj",e))},ok:function(){var e=this;e.trigger("beforeok"),!1!==e.trigger("ok",e)&&e.hide()},getBodyContainer:function(){return this.root().find(".edui-modal-body")}}),function(){var t={},n={},i=[],o=null,r={},s={},l={},c=null;d.extend(UM,{defaultWidth:500,defaultHeight:500,registerUI:function(e,n){d.each(e.split(/\s+/),function(e){t[e]=n})},setEditor:function(e){!n[e.id]&&(n[e.id]=e)},registerWidget:function(t,n,i){r[t]=e.extend2(n,{$root:"",_preventDefault:!1,root:function(e){return this.$root||(this.$root=e)},preventDefault:function(){this._preventDefault=!0},clear:!1}),i&&(s[t]=i)},getWidgetData:function(e){return r[e]},setWidgetBody:function(t,n,i){i._widgetData||d.extend(i,{_widgetData:{},getWidgetData:function(e){return this._widgetData[e]},getWidgetCallback:function(e){var t=this;return function(){return s[e].apply(t,[t,n].concat(Array.prototype.slice.call(arguments,0)))}}});var o=r[t];if(!o)return null;o=i._widgetData[t],o||(o=r[t],o=i._widgetData[t]="function"==e.type(o)?o:d.clone(o)),o.root(n.edui().getBodyContainer()),o.initContent(i,n),o._preventDefault||o.initEvent(i,n),o.width&&n.width(o.width)},setActiveWidget:function(e){o=e},getEditor:function(e,t){var i=n[e]||(n[e]=this.createEditor(e,t));return c=c?Math.max(i.getOpt("zIndex"),c):i.getOpt("zIndex"),i},setTopEditor:function(t){e.each(n,function(e,n){t==n?t.$container&&t.$container.css("zIndex",c+1):n.$container&&n.$container.css("zIndex",n.getOpt("zIndex"))})},clearCache:function(e){n[e]&&delete n[e]},delEditor:function(e){var t;(t=n[e])&&t.destroy()},ready:function(e){i.push(e)},createEditor:function(t,n){function o(){var n=this.createUI("#"+t,r);r.key=t,r.ready(function(){e.each(i,function(t,n){e.proxy(n,r)()})});var o=r.options;o.initialFrameWidth?o.minFrameWidth=o.initialFrameWidth:o.minFrameWidth=o.initialFrameWidth=r.$body.width()||UM.defaultWidth,n.css({width:o.initialFrameWidth,zIndex:r.getOpt("zIndex")}),UM.browser.ie&&6===UM.browser.version&&document.execCommand("BackgroundImageCache",!1,!0),r.render(t),e.eduitooltip&&e.eduitooltip("attachTo",e("[data-original-title]",n)).css("z-index",r.getOpt("zIndex")+1),n.find("a").click(function(e){e.preventDefault()}),r.fireEvent("afteruiready")}var r=new UM.Editor(n),a=this;return r.langIsReady?e.proxy(o,a)():r.addListener("langReady",e.proxy(o,a)),r},createUI:function(n,i){var o=e(n),r=e('<div class="edui-container"><div class="edui-editor-body"></div></div>').insertBefore(o);if(i.$container=r,i.container=r[0],i.$body=o,a.ie&&a.ie9above){e('<span style="padding:0;margin:0;height:0;width:0"></span>').insertAfter(r)}return e.each(t,function(e,t){var n=t.call(i,e);n&&(l[e]=n)}),r.find(".edui-editor-body").append(o).before(this.createToolbar(i.options,i)),r.find(".edui-toolbar").append(e('<div class="edui-dialog-container"></div>')),r},createToolbar:function(t,n){var i=e.eduitoolbar(),o=i.edui();if(t.toolbar&&t.toolbar.length){var r=[];e.each(t.toolbar,function(t,n){e.each(n.split(/\s+/),function(t,n){if("|"==n)e.eduiseparator&&r.push(e.eduiseparator());else{var i=l[n];"fullscreen"==n?i&&r.unshift(i):i&&r.push(i)}}),r.length&&o.appendToBtnmenu(r)})}else i.find(".edui-btn-toolbar").remove();return i}})}(),UM.registerUI("bold cleardoc removeformat",function(t){var n=this,i=e.eduibutton({icon:t,click:function(){n.execCommand(t)},title:this.getLang("labelMap")[t]||""});return this.addListener("selectionchange",function(){var e=this.queryCommandState(t);i.edui().disabled(-1==e).active(1==e)}),i}),function(){function t(e){var t=this;if(!e)throw new Error("invalid params, notfound editor");t.editor=e,s[e.uid]=this,e.addListener("destroy",function(){delete s[e.uid],t.editor=null})}var n={},i=["width","height","position","top","left","margin","padding","overflowX","overflowY"],o={},r={},a={},s={};UM.registerUI("fullscreen",function(n){var i=this,o=e.eduibutton({icon:"fullscreen",title:i.options.labelMap&&i.options.labelMap[n]||i.getLang("labelMap."+n),click:function(){i.execCommand(n),UM.setTopEditor(i)}});return i.addListener("selectionchange",function(){var e=this.queryCommandState(n);o.edui().disabled(-1==e).active(1==e)}),i.addListener("ready",function(){i.options.fullscreen&&t.getInstance(i).toggle()}),o}),UM.commands.fullscreen={execCommand:function(e){t.getInstance(this).toggle()},queryCommandState:function(e){return this._edui_fullscreen_status},notNeedUndo:1},t.prototype={toggle:function(){var e=this.editor,t=this.isFullState();e.fireEvent("beforefullscreenchange",!t),this.update(!t),t?this.revert():this.enlarge(),e.fireEvent("afterfullscreenchange",!t),"true"===e.body.contentEditable&&e.fireEvent("fullscreenchanged",!t),e.fireEvent("selectionchange")},enlarge:function(){this.saveSataus(),this.setDocumentStatus(),this.resize()},revert:function(){var t=this.editor.options,n=/%$/.test(t.initialFrameHeight)?"100%":t.initialFrameHeight-this.getStyleValue("padding-top")-this.getStyleValue("padding-bottom")-this.getStyleValue("border-width");e.IE6&&this.getEditorHolder().style.setExpression("height","this.scrollHeight <= "+n+' ? "'+n+'px" : "auto"'),this.revertContainerStatus(),this.revertContentAreaStatus(),this.revertDocumentStatus()},update:function(e){this.editor._edui_fullscreen_status=e},resize:function(){var t=null,n=0,i=0,o=0,r=0,a=this.editor,s=null,l=null;this.isFullState()&&(t=e(window),i=t.width(),n=t.height(),l=this.getEditorHolder(),o=parseInt(p.getComputedStyle(l,"border-width"),10)||0,o+=parseInt(p.getComputedStyle(a.container,"border-width"),10)||0,r+=parseInt(p.getComputedStyle(l,"padding-left"),10)+parseInt(p.getComputedStyle(l,"padding-right"),10)||0,e.IE6&&l.style.setExpression("height",null),s=this.getBound(),e(a.container).css({width:i+"px",height:n+"px",position:e.IE6?"absolute":"fixed",top:s.top,left:s.left,margin:0,padding:0,overflowX:"hidden",overflowY:"hidden"}),e(l).css({width:i-2*o-r+"px",height:n-2*o-(a.options.withoutToolbar?0:e(".edui-toolbar",a.container).outerHeight())-e(".edui-bottombar",a.container).outerHeight()+"px",overflowX:"hidden",overflowY:"auto"}))},saveSataus:function(){for(var e=this.editor.container.style,t=null,o={},r=0,a=i.length;r<a;r++)t=i[r],o[t]=e[t];n[this.editor.uid]=o,this.saveContentAreaStatus(),this.saveDocumentStatus()},saveContentAreaStatus:function(){var t=e(this.getEditorHolder());o[this.editor.uid]={width:t.css("width"),overflowX:t.css("overflowX"),overflowY:t.css("overflowY"),height:t.css("height")}},saveDocumentStatus:function(){var t=e(this.getEditorDocumentBody());r[this.editor.uid]={overflowX:t.css("overflowX"),overflowY:t.css("overflowY")},a[this.editor.uid]={overflowX:e(this.getEditorDocumentElement()).css("overflowX"),overflowY:e(this.getEditorDocumentElement()).css("overflowY")}},revertContainerStatus:function(){e(this.editor.container).css(this.getEditorStatus())},revertContentAreaStatus:function(){var t=this.getEditorHolder(),n=this.getContentAreaStatus();this.supportMin()&&(delete n.height,t.style.height=null),e(t).css(n)},revertDocumentStatus:function(){var t=this.getDocumentStatus();e(this.getEditorDocumentBody()).css("overflowX",t.body.overflowX),e(this.getEditorDocumentElement()).css("overflowY",t.html.overflowY)},setDocumentStatus:function(){e(this.getEditorDocumentBody()).css({overflowX:"hidden",overflowY:"hidden"}),e(this.getEditorDocumentElement()).css({overflowX:"hidden",overflowY:"hidden"})},isFullState:function(){return!!this.editor._edui_fullscreen_status},getEditorStatus:function(){return n[this.editor.uid]},getContentAreaStatus:function(){return o[this.editor.uid]},getEditorDocumentElement:function(){return this.editor.container.ownerDocument.documentElement},getEditorDocumentBody:function(){return this.editor.container.ownerDocument.body},getEditorHolder:function(){return this.editor.body},getDocumentStatus:function(){return{body:r[this.editor.uid],html:a[this.editor.uid]}},supportMin:function(){var e=null;return this._support||(e=document.createElement("div"),this._support="minWidth"in e.style,e=null),this._support},getBound:function(){var t={html:!0,body:!0},n={top:0,left:0},i=null;return e.IE6?(i=this.editor.container.offsetParent,i&&!t[i.nodeName.toLowerCase()]&&(t=i.getBoundingClientRect(),n.top=-t.top,n.left=-t.left),n):n},getStyleValue:function(e){return parseInt(p.getComputedStyle(this.getEditorHolder(),e))}},e.extend(t,{listen:function(){var n=null;t._hasFullscreenListener||(t._hasFullscreenListener=!0,e(window).on("resize",function(){null!==n&&(window.clearTimeout(n),n=null),n=window.setTimeout(function(){for(var e in s)s[e].resize();n=null},50)}))},getInstance:function(e){return s[e.uid]||new t(e),s[e.uid]}}),t.listen()}(),UM.registerUI("imagescale",function(){var t,n=this;n.setOpt("imageScaleEnabled",!0),a.webkit&&n.getOpt("imageScaleEnabled")&&(n.addListener("click",function(i,o){var r=n.selection.getRange(),a=r.getClosedNode(),s=o.target;if(a&&"IMG"==a.tagName&&s==a){if(!t){t=e.eduiscale({$wrap:n.$container}).css("zIndex",n.options.zIndex),n.$container.append(t);var l,d=function(){t.edui().hide()},c=function(e){var t=e.target||e.srcElement;t&&-1==t.className.indexOf("edui-scale")&&d()};t.edui().on("aftershow",function(){e(document).bind("keydown",d),e(document).bind("mousedown",c),n.selection.getNative().removeAllRanges()}).on("afterhide",function(){e(document).unbind("keydown",d),e(document).unbind("mousedown",c);var i=t.edui().getScaleTarget();i.parentNode&&n.selection.getRange().selectNode(i).select()}).on("mousedown",function(e){n.selection.getNative().removeAllRanges();var i=e.target||e.srcElement;i&&-1==i.className.indexOf("edui-scale-hand")&&(l=setTimeout(function(){t.edui().hide()},200))}).on("mouseup",function(e){var t=e.target||e.srcElement;t&&-1==t.className.indexOf("edui-scale-hand")&&clearTimeout(l)})}t.edui().show(e(a))}else t&&"none"!=t.css("display")&&t.edui().hide()}),n.addListener("click",function(e,t){if("IMG"==t.target.tagName){new o.Range(n.document,n.body).selectNode(t.target).select()}}))}),UM.registerUI("autofloat",function(){var t=this,n=t.getLang();t.setOpt({autoFloatEnabled:!0,topOffset:0});var i=!1!==t.options.autoFloatEnabled,o=t.options.topOffset;i&&t.ready(function(){function i(){if(!v){var e=p.getXY(c),n=p.getComputedStyle(c,"position"),i=p.getComputedStyle(c,"left");c.style.width=c.offsetWidth+"px",c.style.zIndex=1*t.options.zIndex+1,c.parentNode.insertBefore(m,c),f||h&&a.ie?("absolute"!=c.style.position&&(c.style.position="absolute"),c.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-u+o+"px"):"fixed"!=c.style.position&&(c.style.position="fixed",c.style.top=o+"px",("absolute"==n||"relative"==n)&&parseFloat(i)&&(c.style.left=e.x+"px"))}}function r(){m.parentNode&&m.parentNode.removeChild(m),c.style.cssText=l}function s(){var e=g(t.container),n=t.options.toolbarTopOffset||0;e.top<0&&e.bottom-c.offsetHeight>n?i():r()}var l,c,u,f=a.ie&&a.version<=6,h=a.quirks,m=document.createElement("div"),g=function(e){var t;try{t=e.getBoundingClientRect()}catch(e){t={left:0,top:0,height:0,width:0}}for(var n,i={left:Math.round(t.left),top:Math.round(t.top),height:Math.round(t.bottom-t.top),width:Math.round(t.right-t.left)};(n=e.ownerDocument)!==document&&(e=p.getWindow(n).frameElement);)t=e.getBoundingClientRect(),i.left+=t.left,i.top+=t.top;return i.bottom=i.top+i.height,i.right=i.left+i.width,i},v=!1,b=d.defer(function(){s()},a.ie?200:100,!0);t.addListener("destroy",function(){e(window).off("scroll resize",s),t.removeListener("keydown",b)}),function(){return UM.ui?1:(alert(n.autofloatMsg),0)}()&&(c=e(".edui-toolbar",t.container)[0],t.addListener("afteruiready",function(){setTimeout(function(){u=e(c).offset().top},100)}),l=c.style.cssText,m.style.height=c.offsetHeight+"px",f&&function(){var e=document.body.style;e.backgroundImage='url("about:blank")',e.backgroundAttachment="fixed"}(),e(window).on("scroll resize",s),t.addListener("keydown",b),t.addListener("resize",function(){r(),m.style.height=c.offsetHeight+"px",s()}),t.addListener("beforefullscreenchange",function(e,t){t&&(r(),v=t)}),t.addListener("fullscreenchanged",function(e,t){t||s(),v=t}),t.addListener("sourcemodechanged",function(e,t){setTimeout(function(){s()},0)}),t.addListener("clearDoc",function(){setTimeout(function(){s()},0)}))})}),UM.registerUI("paragraph fontfamily fontsize",function(t){function n(t,i){var o=e("<span>").html(t).css({display:"inline",position:"absolute",top:-1e7,left:-1e5}).appendTo(document.body),r=o.width();return o.remove(),o=null,r<50?t:(t=t.slice(0,i?-4:-1),t.length?n(t+"...",!0):"...")}var i=this,o=i.options.labelMap&&i.options.labelMap[t]||i.getLang("labelMap."+t),r={label:o,title:o,comboboxName:t,items:i.options[t]||[],itemStyles:[],value:[],autowidthitem:[]},a=null,s=null;if(0==r.items.length)return null;switch(t){case"paragraph":r=function(e){var t=[];for(var i in e.items)e.value.push(i),t.push(i),e.autowidthitem.push(n(i));return e.items=t,e.autoRecord=!1,e}(r);break;case"fontfamily":r=function(e){for(var t=null,i=[],o=0,r=e.items.length;o<r;o++)t=e.items[o].val,i.push(t.split(/\s*,\s*/)[0]),e.itemStyles.push("font-family: "+t),e.value.push(t),e.autowidthitem.push(n(i[o]));return e.items=i,e}(r);break;case"fontsize":r=function(e){var t=null,n=[];e.itemStyles=[],e.value=[];for(var i=0,o=e.items.length;i<o;i++)t=e.items[i],n.push(t),e.itemStyles.push("font-size: "+t+"px");return e.value=e.items,e.items=n,e.autoRecord=!1,e}(r)}return a=e.eduibuttoncombobox(r).css("zIndex",i.getOpt("zIndex")+1),s=a.edui(),s.on("comboboxselect",function(e,n){i.execCommand(t,n.value)}).on("beforeshow",function(){0===a.parent().length&&a.appendTo(i.$container.find(".edui-dialog-container")),UM.setTopEditor(i)}),this.addListener("selectionchange",function(e){var n=this.queryCommandState(t),i=this.queryCommandValue(t);s.button().edui().disabled(-1==n).active(1==n),i&&(i=i.replace(/['"]/g,"").toLowerCase().split(/['|"]?\s*,\s*[\1]?/),s.selectItemByLabel(i))}),s.button().addClass("edui-combobox")})}(jQuery),UM.I18N["zh-cn"]={labelMap:{anchor:"锚点",undo:"撤销",redo:"重做",bold:"加粗",indent:"首行缩进",snapscreen:"截图",italic:"斜体",underline:"下划线",strikethrough:"删除线",subscript:"下标",fontborder:"字符边框",superscript:"上标",formatmatch:"格式刷",source:"源代码",blockquote:"引用",pasteplain:"纯文本粘贴模式",selectall:"全选",print:"打印",preview:"预览",horizontal:"分隔线",removeformat:"清除格式",time:"时间",date:"日期",unlink:"取消链接",insertrow:"前插入行",insertcol:"前插入列",mergeright:"右合并单元格",mergedown:"下合并单元格",deleterow:"删除行",deletecol:"删除列",splittorows:"拆分成行",splittocols:"拆分成列",splittocells:"完全拆分单元格",mergecells:"合并多个单元格",deletetable:"删除表格",cleardoc:"清空文档",insertparagraphbeforetable:"表格前插入行",insertcode:"代码语言",fontfamily:"字体",fontsize:"字号",paragraph:"段落格式",image:"图片",edittable:"表格属性",edittd:"单元格属性",link:"超链接",emotion:"表情",spechars:"特殊字符",searchreplace:"查询替换",map:"Baidu地图",gmap:"Google地图",insertvideo:"视频",help:"帮助",justifyleft:"居左对齐",justifyright:"居右对齐",justifycenter:"居中对齐",justifyjustify:"两端对齐",forecolor:"字体颜色",backcolor:"背景色",insertorderedlist:"有序列表",insertunorderedlist:"无序列表",fullscreen:"全屏",directionalityltr:"从左向右输入",directionalityrtl:"从右向左输入",rowspacingtop:"段前距",rowspacingbottom:"段后距",highlightcode:"插入代码",pagebreak:"分页",insertframe:"插入Iframe",imagenone:"默认",imageleft:"左浮动",imageright:"右浮动",attachment:"附件",imagecenter:"居中",wordimage:"图片转存",lineheight:"行间距",edittip:"编辑提示",customstyle:"自定义标题",autotypeset:"自动排版",webapp:"百度应用",touppercase:"字母大写",tolowercase:"字母小写",background:"背景",template:"模板",scrawl:"涂鸦",music:"音乐",inserttable:"插入表格"},image:{static:{lang_tab_local:"本地上传",lang_tab_imgSearch:"网络图片",lang_input_dragTip:"支持图片拖拽上传",lang_btn_add:"添加"}},link:{static:{lang_input_text:"文本内容：",lang_input_url:"链接地址：",lang_input_title:"标题：",lang_input_target:"是否在新窗口打开："},validLink:"只支持选中一个链接时生效",httpPrompt:"您输入的超链接中不包含http等协议名称，默认将为您添加http://前缀"}}},"./src/module/objectEditor.js":function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("./node_modules/babel-runtime/helpers/classCallCheck.js"),r=i(o),a=n("./node_modules/babel-runtime/helpers/createClass.js"),s=i(a);n("./src/libs/ueditor/editor.js");var l=function(){function e(t){(0,r.default)(this,e),this._foreColors=["c00000","ff0000","ffc000","ffff00","92d050","00b050","00b0f0","0070c0","002060","7030a0","000000"],this._backColors=["ff9595","ffba80","fafa4b","bbf57c","7cf2a1","acebff","9ec9ff","d4aeff","ffffff"],this.init(t)}return(0,s.default)(e,[{key:"init",value:function(e){var t=this;this.params=e.params||{},e.onAfterCreated&&(this.onAfterCreated=e.onAfterCreated),e.modal&&(t.modal=e.modal),e=$.extend({minlength:5,maxlength:1e4},e),this.minlength=e.minlength,this.maxlength=e.maxlength,t.editorId="object_editor_"+e.textAreaId,e.needFullScreen=!1,t.container=e.container.css("position","relative").append('<div class="object-editor" action="#" method="post"><header onmousedown="return false"><ul class="object-editor-tool-bar clearfix" id="object_editor_tools"><li data-role="face"><i class="i-block i-face"></i>表情</li><li data-role="img"><i class="i-block i-img"></i>图片</li><li class="divider"></li><li data-role="forecolor"><i class="i-block i-forecolor"><em class="fore-color" data-role="foreColor"></em></i>颜色</li><li data-role="bold"><i class="i-block i-bold"></i>加粗</li><li data-role="backcolor"><i class="i-block i-backcolor"><em class="back-color" data-role="backColor"></em></i>底色</li><li data-role="removeformat"><i class="i-block i-removeformat"></i>清除格式</li>'+(e.needFullScreen?'<li data-role="fullscreen"><i class="i-block i-fullscreen"><em class="full-screen" data-role="fullscreen"></em></i>全屏</li>':"")+'</ul></header><div class="textarea" id="'+t.editorId+'"></div></div>'),t.initToolbar(t.container.children("div").children("header")),t.editor=UM.getEditor(t.editorId,{toolbar:["forecolor"],initialFrameWidth:"100%",initialFrameHeight:250}),t.editor.$body.on("focus",function(){t.hideDialog("face"),t.hideDialog("img"),t.hideDialog("forecolor"),t.hideDialog("backcolor")}),t.editor.addListener("selectionchange",function(){var e=this.queryCommandState("forecolor");e=!e||e<0?"":e.toLowerCase().split("#")[1],$.inArray(e,t._foreColors)>-1?t.toolbar.find('em[data-role="foreColor"]').css("background-color","#"+e).closest("li").addClass("active"):t.toolbar.find('em[data-role="foreColor"]').removeAttr("style").closest("li").removeClass("active"),e=this.queryCommandState("bold"),1==e?t.toolbar.find('li[data-role="bold"]').addClass("active"):t.toolbar.find('li[data-role="bold"]').removeClass("active"),e=this.queryCommandState("backcolor"),e=!e||e<0?"":e.toLowerCase().split("#")[1],$.inArray(e,t._backColors)>-1?t.toolbar.find('em[data-role="backColor"]').css("background-color","#"+e).closest("li").addClass("active"):t.toolbar.find('em[data-role="backColor"]').removeAttr("style").closest("li").removeClass("active")}),e.autoSave&&(void 0===$.support.localStorage&&($.support.localStorage="localStorage"in window&&null!==window.localStorage),$.support.localStorage&&localStorage.getItem("objectEditorContent")&&t.editor.execCommand("inserthtml",localStorage.getItem("objectEditorContent"),!0),$(window).on("beforeunload",function(){if(t.editor.hasContents()&&(!t.modal||t.modal.is(":visible")))return void 0===$.support.localStorage&&($.support.localStorage="localStorage"in window&&null!==window.localStorage),void($.support.localStorage&&localStorage.setItem("objectEditorContent",t.editor.getPlainTxt()))}))}},{key:"initToolbar",value:function(e){var t=this;t.toolbar=e,t.toolbar.on("mouseenter","li",function(){$(this).addClass("hover").siblings("li").removeClass("hover")}).on("mouseleave","li",function(){$(this).removeClass("hover")}).on("click","li",function(){var e=$(this),n=e.attr("data-role");if("bold"===n)t.editor.execCommand("bold");else if("removeformat"===n)t.editor.execCommand("removeformat");else if("fullscreen"===n)t.fullscreen&&$.isFunction(t.fullscreen)&&t.fullscreen();else if(t[n+"DialogIsShow"])t.hideDialog(n);else if(t[n+"Dialog"]||t.createDialog(n),t.showDialog(n),"forecolor"===n){var i=t.editor.queryCommandState("forecolor"),o=t.forecolorDialog.find('span[data-color="'+i.replace(/#/,"").toLowerCase()+'"]');t.forecolorDialog.find("li.active").removeClass("active"),0!==o.length&&o.closest("li").addClass("active")}else if("backcolor"===n){var r=t.editor.queryCommandState("backcolor"),a=t.backcolorDialog.find('span[data-color="'+r.replace(/#/,"").toLowerCase()+'"]');t.backcolorDialog.find("li.active").removeClass("active"),0!==a.length&&a.closest("li").addClass("active")}})}},{key:"createDialog",value:function(e){switch(e){case"face":this.createFaceDialog();break;case"img":this.createImgDialog();break;case"forecolor":this.createForecolorDialog();break;case"backcolor":this.createBackcolorDialog()}}},{key:"createFaceHeader",value:function(e,t){if($(".face-header").hide(),this.pkgIndex[t])$('ul[data-index="'+t+'"]').show();else{var n='<ul class="face-header clearfix" data-index='+t+">",i=void 0;i=e[0],n+='<li class="face-pkg"><img data-role="emotion-pkg" title="'+i.value[0].name+'" alt="'+i.name+'" src="'+this._linkTop+"normal/"+i.value[0].url+'"></li>',n+="</ul>",$(n).prependTo($(".editor-dialog-face").eq(0)),this.pkgIndex[t]=!0}}},{key:"getFaceBlock",value:function(e,t){this.faceDialog.find("div.face-wrap").hide();var n=$("#dom_face_"+t);if(n.length)n.show();else{var i=void 0,o=e[t],r=void 0,a=o.length,s="normal"===t?"normal/":"middle/"+t+"/",l="normal"===t?"face face-sm":"face face-bg",d='<div class="face-wrap" id="dom_face_'+t+'">';for(d+='<ul class="face-list clearfix">',r=1;r<a;r++)i=o[r],d+='<li class="'+l+'"><img data-role="emotion" title="'+i.name+'" alt="'+i.name+'" src="'+this._linkTop+s+i.url+'"></li>';$(d+"</ul></div>").insertBefore($("#dom_face_preview"))}}},{key:"createFaceDialog",value:function(){this._linkTop=CONFIG.resourcePath+"/img/emotion/";var e=emotionData.normal;if(e){var t=[];for(var n in emotionData)"normal"!==n&&t.push({name:n,value:emotionData[n]});t=[{name:"normal",value:e}].concat(t);var i='<div class="editor-dialog editor-dialog-face "><i class="i-arr1 bgc"></i><i class="i-arr2 bgc"></i>';i+='<div id="dom_face_preview" class="preview"></div>',this.faceDialog=$(i+"</div>").appendTo(this.container),this.pkgIndex=[],this.createFaceHeader(t,0),$(".face-pkg").eq(0).addClass("active"),this.getFaceBlock(emotionData,"normal"),this.createFaceEvent(emotionData)}}},{key:"createFaceEvent",value:function(e){var t=this,n=$("#dom_face_preview");this.faceDialog.on("click","li.face",function(){var e=$(this).children("img").eq(0),n=e.attr("src").replace("middle","normal").replace("png","gif");t.checkInsertHtmlPos(),t.editor.execCommand("insertHtml",'<img class="tag-face" alt="'+e.attr("alt")+'" role="face" src="'+n+'">',!0),t.hideDialog("face")}).on("click","li.face-pkg",function(){var n=$(this);n.addClass("active").siblings().removeClass("active");var i=n.children("img").eq(0).attr("alt");t.getFaceBlock(e,i)}).on("mouseenter","li.face",function(){$(this).addClass("li-hover")}).on("mouseenter","li.face-bg",function(){var e=$(this),t=e.position();n.empty().html('<i class="fa fa-spinner fa-spin text-muted"></i>').show().css({left:t.left+e.outerWidth()-2+"px",top:t.top-n.outerHeight()+"px"});var i=e.children("img").eq(0),o=new Image;o.onload=function(){n.empty().append(o).css({left:t.left+e.outerWidth()-2+"px",top:t.top-n.outerHeight()+"px"})},o.src=i.attr("src").replace("middle","normal").replace(".png",".gif")}).on("mouseleave","li.face",function(){$(this).removeClass("li-hover"),n.empty().hide()})}},{key:"createImgDialog",value:function(){var e=this;e.imgDialog=$('<div class="editor-dialog editor-dialog-img"><i class="i-arr1"></i><i class="i-arr2"></i><button class="btn-close" type="button" title="关闭">&times;</button><ul class="nav-tab clearfix"><li class="active">本地上传</li></ul><div class="img-list"><p>最多上传10张图片，单张图片请小于5M</p><ul class="imgs clearfix"></ul></div><div class="editor-foot"><button class="btn btn-cancel" type="button" data-action="cancel">取消</button><button class="btn btn-ok" type="button" data-action="ok">插入</button></div></div>'),e.container.append(e.imgDialog),e.imgDialog.find("button.btn-close").on("click",function(){e.hideDialog("img")}),e.imgDialog.on("click","i.fa-trash",function(){var t=$(this),n=t.closest("ul");t.closest("li").remove(),0===n.children("li.btn-add").length&&e.initUploadInput(),t=null}).find("div.editor-foot").on("click","button",function(){if("ok"===$(this).attr("data-action")){var t=e.imgDialog.find("ul.imgs").find("img");if(0===t.length)bootbox.alert({backdrop:!1,animate:!1,className:"section-modal",size:"small",title:"提示",buttons:{ok:{label:"我知道了"}},message:'<p class="text-lg text-warning"><i class="fa fa-warning"></i> 请点击“添加图片”按钮，上传图片</p>'});else{var n=void 0;e.checkInsertHtmlPos();for(var i=0,o=t.length;i<o;i++)n=t.eq(i),e.editor.execCommand("inserthtml",'<img src="'+n.attr("src")+'" data-fileName="'+n.attr("data-fileName")+'" alt="'+n.attr("alt")+'" role="img" />',!0);e.imgDialog.find("ul.imgs").empty(),e.initUploadInput(),e.hideDialog("img")}}else e.hideDialog("img")}),e.initUploadInput()}},{key:"createForecolorDialog",value:function(){var e=this,t=e._foreColors,n="",i=void 0,o=t.length;for(i=0;i<o;i++)n+='<li><span style="background-color:#'+t[i]+'" data-color="'+t[i]+'"></span></li>';e.forecolorDialog=$('<div class="editor-dialog editor-dialog-color" onmousedown="return false"><i class="i-arr1"></i><i class="i-arr2"></i><ul class="color-list clearfix">'+n+"</ul></div>"),e.container.append(e.forecolorDialog),e.forecolorDialog.on("click","li",function(){e.editor.execCommand("forecolor",UM.dom.domUtils.getComputedStyle($(this).children("span")[0],"background-color")),e.hideDialog("forecolor")})}},{key:"createBackcolorDialog",value:function(){var e=this,t=e._backColors,n="",i=void 0,o=t.length;for(i=0;i<o;i++)n+='<li><span style="background-color:#'+t[i]+'" data-color="'+t[i]+'"></span></li>';e.backcolorDialog=$('<div class="editor-dialog editor-dialog-color editor-dialog-backcolor" onmousedown="return false"><i class="i-arr1"></i><i class="i-arr2"></i><ul class="color-list clearfix">'+n+"</ul></div>"),e.container.append(e.backcolorDialog),e.backcolorDialog.on("click","li",function(){var t=UM.dom.domUtils.getComputedStyle($(this).children("span")[0],"background-color");t.toLowerCase(),"#ffffff"!==t?e.editor.execCommand("backcolor",t):e.editor.execCommand("backcolor",""),e.hideDialog("backcolor")})}},{key:"initUploadInput",value:function(){var e=this;e.imgDialog.find("li.btn-add").remove();var t=e.imgDialog.find("ul.imgs").children("li").filter(function(){return!$(this).hasClass("btn-add")}).length;(t+=$(e.editor.body).find('img[role="img"]').length)<10&&(e._imgCount++,e.imgDialog.find("ul.imgs").append('<li class="btn-add"><form action="/post/imageTempUpload.htm" method="post" enctype="multipart/form-data"><span class="i-add">+</span>添加图片<input class="input-file-hide" type="file" accept="image/gif,image/png,image/jpeg" name="uploadImage_'+e._imgCount+'" /></form></li>'),e.imgDialog.find('input[type="file"]').on("change",function(){var t=$(this).closest("form");if(/\.(gif|jpg|jpeg|png)$/.test(this.value.toLowerCase())){var n=Tools.img.getInputFileSize(this),i=!0;if($.isArray(n))for(var o=n.length;o--;)if(n[o]>5242880){i=!1,bootbox.alert({animate:!1,className:"section-modal",size:"small",title:"提示",buttons:{ok:{label:"我知道了"}},backdrop:!1,message:'<p class="text-lg text-warning"><i class="fa fa-warning"></i> 对不起！上传的图片大小不能超过<strong>5M</strong>！</p>'});break}i?(e.imgDialog.find("ul.imgs").find("li.btn-add").after('<li class="loading-item"></li></li>'),Tools.oi.iUpload({form:t,onSuccess:function(t){if(t.success){var n=$('<li><img src="'+t.url+'" alt="'+t.original+'" data-fileName="'+t.fileName+'" /><span class="mask"></span><i class="fa fa-trash" title="删除"></i></li></li>');e.imgDialog.find("li.loading-item").replaceWith(n),n.find("img").on("load",function(){var e=$(this);e.width()/e.height()>1?e.css("width","78px"):e.css("height","78px")}),e.initUploadInput()}else if(e.initUploadInput(),t.errorCode&&"USER_NOT_LOGIN"===t.errorCode)window.location.reload(!0),e.imgDialog.find("li.loading-item").remove(),e.initUploadInput();else{var i=Tools.util.getError(t);if(null!==i){if($.isPlainObject(i)){var o=[];for(var r in i)o.push(i[r]);i=o.join("；")}}else i="对不起，上传图片时发生了错误，请稍候再试。";bootbox.alert({backdrop:!1,animate:!1,className:"section-modal",size:"small",title:"提示",buttons:{ok:{label:"我知道了"}},message:'<p class="text-lg text-warning"><i class="fa fa-warning"></i> '+i+"</p>"})}},onFail:function(t){var n=t.responseText;if(e.imgDialog.find("li.loading-item").remove(),e.initUploadInput(),n.errorCode&&"USER_NOT_LOGIN"===n.errorCode)window.location.reload(!0);else{var i=Tools.util.getError(n);if(null!==i){if($.isPlainObject(i)){var o=[];for(var r in i)o.push(i[r]);i=o.join("；")}}else i="对不起，上传图片时发生了错误，请稍候再试。";bootbox.alert({backdrop:!1,animate:!1,className:"section-modal",size:"small",title:"提示",buttons:{ok:{label:"我知道了"}},message:'<p class="text-lg text-warning"><i class="fa fa-warning"></i> '+i+"</p>"})}},onTimeout:function(){e.imgDialog.find("li.loading-item").remove(),e.initUploadInput(),bootbox.alert({backdrop:!1,animate:!1,className:"section-modal",size:"small",title:"提示",buttons:{ok:{label:"我知道了"}},message:'<p class="text-lg text-warning"><i class="fa fa-warning"></i> 上传图片超时</p>'})}})):e.initUploadInput()}else bootbox.alert({backdrop:!1,animate:!1,className:"section-modal",size:"small",title:"提示",buttons:{ok:{label:"我知道了"}},message:'<p class="text-lg text-warning"><i class="fa fa-warning"></i> 只支持<strong>JPG</strong>、<strong>PNG</strong>、<strong>GIF</strong></p>'}),e.initUploadInput()}))}},{key:"showDialog",value:function(e){for(var t=["face","img","forecolor","backcolor"],n=t.length;n--;)e===t[n]?(this[e+"Dialog"].show(),this[e+"DialogIsShow"]=!0,"img"===e&&this.editor.$body.find('img[role="img"]').length<10&&0===this.imgDialog.find("li.btn-add").length&&this.initUploadInput()):this[t[n]+"Dialog"]&&(this[t[n]+"Dialog"].hide(),this[t[n]+"DialogIsShow"]=!1)}},{key:"hideDialog",value:function(e){this[e+"Dialog"]&&(this[e+"Dialog"].hide(),this[e+"DialogIsShow"]=!1)}},{key:"getValue",value:function(e){var t=this._hideDom;t.empty().append(this.editor.getContent());var n=$.trim(t.text()).length,i="";if(t.find('img[role="img"]').length>10&&(i="图片不能超过<strong>10</strong>张"),""!==i)return bootbox.alert({backdrop:!1,animate:!1,className:"section-modal",size:"small",title:"提示",buttons:{ok:{label:"我知道了"}},message:'<i calss="fa fa-warning text-warning"></i> '+i}),"";for(var o=t.find('img[role="face"]'),r=void 0,a=o.length;a--;)r=o.eq(a),n+=r.attr("alt").length,r.replaceWith(this.formatEmotion(r));for(o=t.find('input[role],img[role="img"]'),a=o.length;a--;)r=o.eq(a),o.is("input")?n+=r.val().length:n+=r.attr("alt").length,r.replaceWith(this.formatTag(r));return e?{_content:t.html(),_len:n}:this.minlength<=1&&0===n?(bootbox.alert({backdrop:!1,animate:!1,className:"section-modal",size:"small",title:"提示",buttons:{ok:{label:"我知道了"}},message:'<i calss="fa fa-warning text-warning"></i> 内容不能为空哦，随便说点什么吧'}),""):this.minlength>1&&n<this.minlength?(bootbox.alert({backdrop:!1,animate:!1,className:"section-modal",size:"small",title:"提示",buttons:{ok:{label:"我知道了"}},message:'<i calss="fa fa-warning text-warning"></i> 内容不能小于<strong>'+this.minlength+"</strong>个字"}),""):n>1e4?(bootbox.alert({backdrop:!1,animate:!1,className:"section-modal",size:"small",title:"提示",buttons:{ok:{label:"我知道了"}},message:'<i calss="fa fa-warning text-warning"></i> 您发表的内容过长'}),""):this.maxlength<1e4&&n>this.maxlength?(bootbox.alert({backdrop:!1,animate:!1,className:"section-modal",size:"small",title:"提示",buttons:{ok:{label:"我知道了"}},message:'<i calss="fa fa-warning text-warning"></i> 发表的内容不能超过<strong>'+this.maxlength+"</strong>个字"}),""):(this.editor.setDisabled("fullscreen"),t.html())}},{key:"formatEmotion",value:function(e){return'<emotion image_name="'+e.attr("src").split("/emotion/")[1]+'" image_alt="'+e.attr("alt")+'">'+e.attr("alt")+"</emotion>"}},{key:"formatTag",value:function(e){switch(e.attr("role")){case"img":return'<upload_image file_name="'+e.attr("data-fileName")+'">[图片]</upload_image>'}}},{key:"clean",value:function(){this.editor.setContent(""),this.cleanLocalStorage(),this.imgDialog&&(this.imgDialog.find("ul.imgs").empty(),this.initUploadInput())}},{key:"cleanLocalStorage",value:function(){$.support.localStorage&&localStorage.removeItem("objectEditorContent")}},{key:"checkInsertHtmlPos",value:function(){var e=this.editor.selection.getRange(),t=e?e.startContainer:null;if(t)if("SPAN"===t.nodeName)e.setStartAfter(t).collapse(!0).select();else{var n=$(t);n.parent().is("span")&&e.setStartAfter(n.parent()[0]).collapse(!0).select()}}}]),e}();t.default=l}},["./src/editorDemo.js"])});